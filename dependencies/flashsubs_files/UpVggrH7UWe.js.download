if (self.CavalryLogger) { CavalryLogger.start_js(["qltax"]); }

__d('MessengerThreadInfoPanelContainer.react',['AsyncRequest','immutable','ImmutableObject','MercuryAPIArgsSource','MercuryIDs','MercuryLogMessageType','MercuryMessageActions','MercuryMessageObject','MercuryThreadActions','MercuryThreadInfo','MercuryTriodeSourceUtil','MessengerActions','messengerDialogsRe','messengerConfirmLeaveGroupDialogReact','messengerContactActionsRe','MessengerAdminGroupUtils','MessengerLeaveGroupAction','MessengerThreadInfoPanelScrollableArea.react','MessengerSettingsActions','MessengerSettingsStore','MessengerThreadInfoPanel.react','ReactComponentWithPureRenderMixin','React','StoreAndPropBasedStateMixin','URI','XMessagingSetThreadStateController','getPageIDFromThreadID'],(function a(b,c,d,e,f,g){'use strict';var h=c('messengerConfirmLeaveGroupDialogReact').jsComponent,i=c('messengerContactActionsRe').actions,j=c('React').PropTypes,k=c('React').createClass({displayName:'MessengerThreadInfoPanelContainer',mixins:[c('ReactComponentWithPureRenderMixin'),c('StoreAndPropBasedStateMixin')(c('MessengerSettingsStore'))],propTypes:{contactData:j.object,participants:j.instanceOf(c('immutable').Map).isRequired,thread:j.instanceOf(c('ImmutableObject')).isRequired,viewer:j.string.isRequired},statics:{calculateState:function l(){var m=c('MessengerSettingsStore').getSettings(),n=m.associated_object_section_collapsed,o=m.people_section_collapsed,p=m.photos_section_collapsed,q=m.files_section_collapsed,r=m.thread_section_collapsed,s=m.group_section_collapsed,t=m.group_approval_section_collapsed;return {associated_object_section_collapsed:n,people_section_collapsed:o,photos_section_collapsed:p,files_section_collapsed:q,thread_section_collapsed:r,group_section_collapsed:s,group_approval_section_collapsed:t};}},render:function l(){var m=this.props.contactData||{},n=this.state,o=n.associated_object_section_collapsed,p=n.people_section_collapsed,q=n.photos_section_collapsed,r=n.files_section_collapsed,s=n.thread_section_collapsed,t=n.group_section_collapsed,u=n.group_approval_section_collapsed;return c('React').createElement(c('MessengerThreadInfoPanelScrollableArea.react'),{className:this.props.className},function(v,w,x,y){return c('React').createElement(c('MessengerThreadInfoPanel.react'),{contact:m.contact,getIsScrolledToBottom:x,getScrollableHeight:y,isUserActive:m.isUserActive||false,lastActive:m.lastActive,onArchive:this._handleArchive,onContactAction:this._handleContactAction,onContactSelect:this._handleContactSelect,onDelete:this._handleDelete,onLeaveGroup:this._handleLeaveGroup,onMarkRead:this._handleMarkRead,onMarkSpam:this._handleMarkSpam,onMarkUnread:this._handleMarkUnread,onMute:this._handleMute,onMuteChange:this._handleMuteChange,onAssociatedObjectSectionToggle:this._handleAssociatedObjectSectionToggle,onPeopleSectionToggle:this._handlePeopleSectionToggle,onPhotosSectionToggle:this._handlePhotosSectionToggle,onFilesSectionToggle:this._handleFilesSectionToggle,onThreadOptionsSectionToggle:this._handleThreadSectionToggle,onGroupOptionsSectionToggle:this._handleGroupOptionsSectionToggle,onGroupApprovalOptionsSectionToggle:this._handleGroupOptionsApprovalSectionToggle,onThreadNameChange:this._handleThreadNameChange,onThreadPhotoChange:this._handleThreadPhotoChange,onUnmute:this._handleUnmute,onBlock:this._handleBlock,onUnblock:this._handleUnblock,showBlock:this.props.thread.is_canonical_user&&this.props.thread.other_user_fbid&&this.props.viewer!==this.props.thread.other_user_fbid,participants:this.props.participants,associatedObjectSectionCollapsed:o,peopleSectionCollapsed:p,photosSectionCollapsed:q,filesSectionCollapsed:r,platform:m.platform,prevIsScrolledToBottom:w,prevScrollableHeight:v,showLeaveGroup:this.props.thread.is_subscribed&&!this.props.thread.is_canonical,showReport:this._isPageChat(),thread:this.props.thread,threadOptionsSectionCollapsed:s,groupOptionsSectionCollapsed:t,groupOptionsApprovalsSectionCollapsed:u,viewer:this.props.viewer});}.bind(this));},_handleArchive:function l(){this._getThreadActions().archive(this.props.thread.thread_id);c('MessengerActions').selectThread(null);},_handleDelete:function l(){this._getThreadActions()['delete'](this.props.thread.thread_id);c('MessengerActions').selectThread(null);},_handleMarkRead:function l(){this._getThreadActions().markRead(this.props.thread.thread_id);},_handleMarkSpam:function l(){this._getThreadActions().markSpam(this.props.thread.thread_id);c('MessengerActions').selectThread(null);},_handleMarkUnread:function l(){this._getThreadActions().markUnread(this.props.thread.thread_id);},_handleMute:function l(m){this._getThreadActions().updateMuteSetting(this.props.thread.thread_id,m);},_handleUnmute:function l(){this._getThreadActions().unmute(this.props.thread.thread_id);},_handleBlock:function l(){this._getThreadActions().blockOnMessengerDotCom(this.props.thread.thread_id);},_handleUnblock:function l(){this._getThreadActions().unblockOnMessengerDotCom(this.props.thread.thread_id);},_handleMuteChange:function l(m){this._getThreadActions().updateMuteSetting(this.props.thread.thread_id,m);},_handleContactSelect:function l(m,event){var n=c('MercuryIDs').getThreadIDFromParticipantID(m.uid);n&&c('MessengerActions').selectThread(n);},_handleContactAction:function l(m,n){if(c('MercuryIDs').getUserIDFromParticipantID(n.uid)!==this.props.viewer)switch(m){case i.MESSAGE:this._handleContactSelect(n);break;case i.PROFILE:var o=this.props.participants.get(n.uid);if(o&&o.href){window.open(o.href);}else this._handleContactSelect(n);break;case i.REMOVE:if(!c('MercuryThreadInfo').isEmptyLocalThread(this.props.thread)){var p=new (c('URI'))('/chat/remove_participants/');p.addQueryData({uid:c('MercuryIDs').getUserIDFromParticipantID(n.uid),tid:this.props.thread.thread_fbid});var q=new (c('AsyncRequest'))(p);q.send();}break;}switch(m){case i.REMOVE_OWNER:if(!c('MercuryThreadInfo').isEmptyLocalThread(this.props.thread))this._getThreadActions().changeGroupAdmins(this.props.thread.thread_fbid,[c('MercuryIDs').getUserIDFromParticipantID(n.uid)],false);break;case i.ADD_OWNER:if(!c('MercuryThreadInfo').isEmptyLocalThread(this.props.thread))this._getThreadActions().changeGroupAdmins(this.props.thread.thread_fbid,[c('MercuryIDs').getUserIDFromParticipantID(n.uid)],true);break;}},_handleLeaveGroup:function l(){var m,n=this;if(this.props.viewer)(function(){var o=c('MessengerAdminGroupUtils').isViewerAdmin(n.props.thread.admin_ids,n.props.viewer);c('messengerDialogsRe').showDialog(function(){return c('React').createElement(h,{onLeave:this._onLeaveGroupConfirm,isViewerAdmin:o,thread:this.props.thread});}.bind(n));})();},_onLeaveGroupConfirm:function l(){c('MessengerLeaveGroupAction').leaveGroup(this.props.thread,this.props.viewer);},_handleThreadNameChange:function l(m){var n=c('MessengerAdminGroupUtils').isJoinableThread(this.props.thread);if(!n){this._getMessageActions().send(this._getMessageObject().constructLogMessageObject(c('MercuryTriodeSourceUtil').getMercuryTriodeSource(),this.props.thread.thread_id,c('MercuryLogMessageType').THREAD_NAME,{name:m}),null,c('MercuryAPIArgsSource').MESSENGER);}else{var o=c('XMessagingSetThreadStateController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(o).setData({thread_id:this.props.thread.thread_fbid,thread_name:m}).send();}},_handleThreadPhotoChange:function l(m,n){this._getMessageActions().send(this._getMessageObject().constructLogMessageObject(c('MercuryTriodeSourceUtil').getMercuryTriodeSource(),m,c('MercuryLogMessageType').THREAD_IMAGE,{image:n.metadata[0]}));},_handleAssociatedObjectSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({associated_object_section_collapsed:!this.state.associated_object_section_collapsed});},_handlePeopleSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({people_section_collapsed:!this.state.people_section_collapsed});},_handlePhotosSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({photos_section_collapsed:!this.state.photos_section_collapsed});},_handleFilesSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({files_section_collapsed:!this.state.files_section_collapsed});},_handleThreadSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({thread_section_collapsed:!this.state.thread_section_collapsed});},_handleGroupOptionsSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({group_section_collapsed:!this.state.group_section_collapsed});},_handleGroupOptionsApprovalSectionToggle:function l(){c('MessengerSettingsActions').changeSettings({group_approval_section_collapsed:!this.state.group_approval_section_collapsed});},_getThreadActions:function l(){return c('MercuryThreadActions').getForFBID(this.props.viewer);},_getMessageActions:function l(){return c('MercuryMessageActions').getForFBID(this.props.viewer);},_getMessageObject:function l(){return c('MercuryMessageObject').getForFBID(this.props.viewer);},_isPageChat:function l(){return !!c('getPageIDFromThreadID')(this.props.thread.thread_id);}});f.exports=k;}),null);