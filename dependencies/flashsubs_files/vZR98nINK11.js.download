if (self.CavalryLogger) { CavalryLogger.start_js(["EMpIk"]); }

__d("RTCCallActionTypes",[],(function a(b,c,d,e,f,g){f.exports={INCOMING_CALL_SUCCESS:"INCOMING_CALL_SUCCESS",RESET:"RESET",REMOTE_VIDEO_MUTED:"REMOTE_VIDEO_MUTED",REMOTE_VIDEO_UNMUTED:"REMOTE_VIDEO_UNMUTED"};}),null);
__d("RTCGroupCallActionTypes",[],(function a(b,c,d,e,f,g){f.exports={CALL:"CALL",CALL_SUCCESS:"CALL_SUCCESS",CALL_ERROR:"CALL_ERROR",INIT:"INIT",WAIT_FOR_USER_INPUT:"WAIT_FOR_USER_INPUT",SET_CALL_SUMMARY:"SET_CALL_SUMMARY",SET_MW_CALL_TYPE:"SET_MW_CALL_TYPE",SET_LAYOUT:"SET_LAYOUT",SET_DOMINANT_SPEAKER:"SET_DOMINANT_SPEAKER",SET_PINNED_SPEAKER:"SET_PINNED_SPEAKER",SET_USE_DOMINANT_SPEAKE_VIEW:"SET_USE_DOMINANT_SPEAKE_VIEW",SET_GRID_VIEW:"SET_GRID_VIEW",INIT_THREAD:"INIT_THREAD",ON_PARTICIPANT_LEFT:"ON_PARTICIPANT_LEFT",ON_PARTICIPANTS_ADDED:"ON_PARTICIPANTS_ADDED",ADD_PARTICIPANTS_TO_RING:"ADD_PARTICIPANTS_TO_RING",JOIN:"JOIN",JOIN_SUCCESS:"JOIN_SUCCESS",JOIN_ERROR:"JOIN_ERROR",HANGUP:"HANGUP",HANGUP_SUCCESS:"HANGUP_SUCCESS",HANGUP_ERROR:"HANGUP_ERROR",ON_CONFERENCE_STATE:"ON_CONFERENCE_STATE",DISMISS:"DISMISS",END_CALL:"END_CALL",ON_JOIN_REQUEST_SENT:"ON_JOIN_REQUEST_SENT",ON_JOIN_RESPONSE:"ON_JOIN_RESPONSE",ON_SERVER_MEDIA_UPDATE_SUCCESS:"ON_SERVER_MEDIA_UPDATE_SUCCESS",ON_CLIENT_MEDIA_UPDATE_RESPONSE:"ON_CLIENT_MEDIA_UPDATE_RESPONSE",INIT_LOCAL_USER:"INIT_LOCAL_USER",INIT_REMOTE_USERS:"INIT_REMOTE_USERS",ADD_REMOTE_STREAM:"ADD_REMOTE_STREAM",REMOVE_REMOTE_STREAM:"REMOVE_REMOTE_STREAM",REMOVE_ALL_REMOTE_STREAMS:"REMOVE_ALL_REMOTE_STREAMS",ADD_REMOTE_TRACK:"ADD_REMOTE_TRACK",REMOVE_REMOTE_TRACK:"REMOVE_REMOTE_TRACK",AUDIO_MUTED:"AUDIO_MUTED",AUDIO_UNMUTED:"AUDIO_UNMUTED",VIDEO_MUTED:"VIDEO_MUTED",VIDEO_UNMUTED:"VIDEO_UNMUTED",SELF_VIEW_COLLAPSED:"SELF_VIEW_COLLAPSED",SELF_VIEW_UNCOLLAPSED:"SELF_VIEW_UNCOLLAPSED",ADD_LOCAL_STREAM:"ADD_LOCAL_STREAM",REMOVE_LOCAL_STREAM:"REMOVE_LOCAL_STREAM",REPLACE_LOCAL_STREAM:"REPLACE_LOCAL_STREAM",REMOVE_ALL_LOCAL_STREAMS:"REMOVE_ALL_LOCAL_STREAMS",ADD_LOCAL_SCREEN_STREAM:"ADD_LOCAL_SCREEN_STREAM",REMOVE_LOCAL_SCREEN_STREAM:"REMOVE_LOCAL_SCREEN_STREAM",REMOVE_ALL_LOCAL_SCREEN_STREAMS:"REMOVE_ALL_LOCAL_SCREEN_STREAMS",ADD_REMOTE_SCREEN_STREAM:"ADD_REMOTE_SCREEN_STREAM",REMOVE_REMOTE_SCREEN_STREAM:"REMOVE_REMOTE_SCREEN_STREAM",TOGGLE_REMOTE_STREAM:"TOGGLE_REMOTE_STREAM",SUBMIT_RATING:"SUBMIT_RATING",SUBMIT_FEEDBACK:"SUBMIT_FEEDBACK",RATING_SHOWN:"RATING_SHOWN",FEEDBACK_SHOWN:"FEEDBACK_SHOWN"};}),null);
__d('intlSummarizeNumber',['fbt','formatNumber'],(function a(b,c,d,e,f,g,h){function i(j){var k=arguments.length<=1||arguments[1]===undefined?0:arguments[1];j=parseFloat(j.toFixed(k));if(Math.abs(j)<1000)return c('formatNumber')(j,k);j=parseFloat((j/1000).toFixed(k||1));if(Math.abs(j)<1000)return String(h._("{number}k",[h.param('number',c('formatNumber')(j,k||j%1&&1))]));j=parseFloat((j/1000).toFixed(k||1));if(Math.abs(j)<1000)return String(h._("{number}M",[h.param('number',c('formatNumber')(j,k||j%1&&1))]));j=parseFloat((j/1000).toFixed(k||1));return String(h._("{number}bn",[h.param('number',c('formatNumber')(j,k||j%1&&1))]));}f.exports=i;}),null);
__d('Facepile.react',['cx','fbt','ix','intlSummarizeNumber','joinClasses','HovercardLink','Image.react','Link.react','List.react','React'],(function a(b,c,d,e,f,g,h,i,j){var k=c('React').PropTypes,l={small:24,medium:32,large:50},m=c('React').createClass({displayName:'Facepile',defaultProps:{moreColor:'blue',moreCount:0,showHovercard:false,tooltipPosition:'above',showToolTip:true,spacing:'none'},propTypes:{className:k.string,moreColor:k.oneOf(['blue','gray']),moreCount:k.number,moreDialogLink:k.string,morePageLink:k.string,numFaces:k.number,onFaceClick:k.func,onComponentDidMount:k.func,profiles:k.arrayOf(k.shape({URL:k.any,name:k.node.isRequired,uniqueID:k.any.isRequired,profilePicURI:k.any.isRequired})).isRequired,showHovercard:k.bool,size:k.oneOf([28,'small','medium','large']).isRequired,spacing:k.oneOf(['none','small','medium','large']),showToolTip:k.bool,tooltipPosition:k.oneOf(['above','below','left','right'])},_onFaceClick:function n(o,p){if(this.props.onFaceClick)this.props.onFaceClick(o,p);},componentDidMount:function n(){if(this.props.onComponentDidMount)this.props.onComponentDidMount();},getPicSize:function n(){return l[this.props.size]||this.props.size;},renderFace:function n(o,p){var q=this.getPicSize(),r=c('HovercardLink').constructEndpoint({id:o.uniqueID}).toString();return c('React').createElement('li',{className:"_43q7",key:o.uniqueID,onClick:this._onFaceClick.bind(this,o,p)},c('React').createElement(c('Link.react'),{'aria-label':o.name,className:"_2rt_ link",'data-hover':!this.props.showHovercard?'tooltip':null,'data-hovercard':this.props.showHovercard?r:null,'data-ignoreclass':"_2rt_",'data-tooltip-alignh':'left','data-tooltip-content':o.name,'data-tooltip-position':this.props.tooltipPosition,href:o.URL},c('React').createElement(c('Image.react'),{src:o.profilePicURI,width:q,height:q,className:'img'})));},renderMore:function n(){if(!this.props.moreCount)return null;var o=this.props.numFaces!=null&&this.props.numFaces<=this.props.profiles.length?this.props.moreCount+1:this.props.moreCount,p=c('intlSummarizeNumber')(o,0),q=p.length,r;if(o===0||this.props.size==='small'&&q>2||this.props.size===28&&q>3||this.props.size==='medium'&&q>3||this.props.size==='large'&&q>6){r=c('React').createElement(c('Image.react'),{src:j("97502")});}else r='+'+p;var s;if(this.props.showToolTip===undefined||this.props.showToolTip===true)if(o===1){s=i._("1 other person");}else s=i._("{num} other people",[i.param('num',o)]);var t=c('joinClasses')("_43q8"+(' '+"_43q7")+(q<2?' '+"_43qa":'')+(q===2?' '+"_43qb":'')+(q===3?' '+"_43qd":'')+(q>3?' '+"_43qe":'')+(this.props.moreColor==='blue'?' '+"_49c8":'')+(this.props.moreColor==='gray'?' '+"_49cb":''));return c('React').createElement('li',{className:t},c('React').createElement('a',{'data-hover':s?'tooltip':null,'data-tooltip-position':s?'right':null,'data-tooltip-content':s,ajaxify:this.props.moreDialogLink||this.props.morePageLink,href:this.props.morePageLink,role:'button',rel:this.props.moreDialogLink?'dialog':null},r));},render:function n(){var o=this.props.spacing||this.defaultProps.spacing,p=c('joinClasses')(this.props.className,"_43qm"+(this.props.size==28?' '+"_3cxu":'')+(this.props.size=='small'?' '+"_43q9":'')+(this.props.size=='medium'?' '+"_43qc":'')+(this.props.size=='large'?' '+"_43qf":'')+(o!=this.defaultProps.spacing?' '+"_4nab":'')),q=this.props.numFaces==undefined?this.props.profiles:this.props.profiles.slice(0,this.props.moreCount?this.props.numFaces-1:this.props.numFaces);return c('React').createElement('div',{className:p,style:this.props.style},c('React').createElement(c('List.react'),{className:"_4cg3",direction:'horizontal',spacing:this.props.spacing||'none',border:'none'},q.map(this.renderFace),this.renderMore()));}});f.exports=m;}),null);
__d("MultiwayTypes",[],(function a(b,c,d,e,f,g){var h={OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONDITIONAL_REQUEST_FAILED:412,BUSY_HERE:486,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503,PRECONDITION_FAILURE:580},i={JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,EXPERIMENT:12},j={AUDIO:0,VIDEO:1,DATA:2},k={IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5},l={CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7},m={SUPPORT_AUDIO:0,SUPPORT_VIDEO:1},n={GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4},o={OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10},p={UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11},q={LOW:0,MEDIUM:1,HIGH:2};f.exports={RtcResponseStatusCode:h,MessageType:i,MediaType:j,RingType:n,HangupReason:k,DismissReason:l,Capability:m,DeviceStatus:o,ParticipantCallState:p,VideoQuality:q};}),null);
__d('MessengerRTCGroupCallContactListItem.react',['cx','fbt','ix','Image.react','Link.react','messengerContactImageReact','MultiwayTypes','React','emptyFunction'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l=c('messengerContactImageReact').jsComponent,m=c('MultiwayTypes').ParticipantCallState,n=(k={},k[m.DISCONNECTED]=i._("Disconnected"),k[m.NO_ANSWER]=i._("No answer"),k[m.REJECTED]=i._("Rejected"),k[m.UNREACHABLE]=i._("Unreachable"),k[m.CONNECTION_DROPPED]=i._("Connection dropped"),k[m.CONTACTING]=i._("Contacting..."),k[m.RINGING]=i._("Ringing..."),k[m.CONNECTING]=i._("Connecting..."),k[m.CONNECTED]=i._("Connected"),k[m.PARTICIPANT_LIMIT_REACHED]=i._("Participant limit reached"),k[m.IN_ANOTHER_CALL]=i._("In another call"),k),o=32,p=function t(u){var v=u.isSelected,w=u.onClick,x=u.participant,y=u.participantState;return c('React').createElement(c('Link.react'),{'aria-checked':v,className:"_4nvn",onClick:s(y)?c('emptyFunction'):w,role:'checkbox'},c('React').createElement(l,{className:"_4nvr",isMessengerUser:x.is_messenger_user,size:o,src:x.image_src}),c('React').createElement('div',{className:"_4nvs"},c('React').createElement('div',{className:"_4nvt"},c('React').createElement('div',{className:"_4nv_"},x.name),c('React').createElement(q,{participant:x,participantState:y})),c('React').createElement(r,{isSelected:v,participantState:y})));},q=function t(u){var v=u.participant.vanity,w=u.participantState;if(w){var x=n[w.state]||i._("Unknown");return c('React').createElement('div',{className:"_4nw0"},x);}if(v)return c('React').createElement('div',{className:"_4nw0"},'@',v);return null;},r=function t(u){var v=u.isSelected,w=u.participantState;if(s(w)){return c('React').createElement('div',{className:"_1j79"},i._("In call"));}else if(v)return c('React').createElement('div',{className:"_1j79"},c('React').createElement(c('Image.react'),{src:j("86852")}));return null;};function s(t){if(!t)return false;switch(t.state){case m.CONTACTING:case m.RINGING:case m.CONNECTING:case m.CONNECTED:return true;default:return false;}}f.exports=p;}),null);
__d('MessengerRTCGroupCallContactList.react',['cx','immutable','MessengerRTCGroupCallContactListItem.react','MessengerScrollableArea.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=function j(k){var l=k.isParticipantSelected,m=k.onClick,n=k.participants,o=k.participantStates,p=o===undefined?c('immutable').Map():o,q=n.map(function(r){return c('React').createElement(c('MessengerRTCGroupCallContactListItem.react'),{isSelected:l.get(r.id),key:r.id,onClick:function(s){function t(){return s.apply(this,arguments);}t.toString=function(){return s.toString();};return t;}(function(){return m(r.id);}),participant:r,participantState:p.get(r.fbid||'')});});return c('React').createElement(c('MessengerScrollableArea.react'),{className:"_12zw"},q);};f.exports=i;}),null);
__d('MessengerRTCGroupCallIncomingDialog.react',['cx','fbt','Facepile.react','ImageBlock.react','ImmutableObject','messengerDialogsRe','messengerContactImageReact','MessengerDialog.react','messengerDialogBodyReact','MessengerDialogButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('messengerContactImageReact').jsComponent,k=c('messengerDialogBodyReact').jsComponent,l=c('React').PropTypes,m=400,n=5,o=50,p=function v(w){var x=w.hasVideo,y=w.caller,z=w.callees,aa=w.onAnswer,ba=w.onIgnore;return c('React').createElement(c('MessengerDialog.react'),{layerHideOnBlur:false,shown:true,onToggle:function ca(da){return u(da,ba);},width:m},c('React').createElement(q,{hasVideo:x}),c('React').createElement(r,{hasVideo:x,caller:y,callees:z}),c('React').createElement(c('MessengerDialogFooter.react'),null,c('React').createElement(c('MessengerDialogButton.react'),{label:i._("Ignore"),onClick:function ca(){return s(ba);},type:'secondary'}),c('React').createElement(c('MessengerDialogButton.react'),{label:i._("Answer Call"),onClick:function ca(){return t(aa);},type:'primary'})));},q=function v(w){var x=w.hasVideo;return c('React').createElement(c('MessengerDialogHeader.react'),null,x?i._("Incoming group video chat"):i._("Incoming group call"));},r=function v(w){var x=w.hasVideo,y=w.caller,z=w.callees;return c('React').createElement(k,null,c('React').createElement(c('ImageBlock.react'),null,c('React').createElement(j,{isMessengerUser:y.is_messenger_user,size:o,src:y.big_image_src||y.image_src}),c('React').createElement('div',{className:"_2n1r"},c('React').createElement('div',{className:"_2n1s"},x?i._("{caller name} started a group video chat in a group you're a member of.",[i.param('caller name',y.name)]):i._("{caller name} started a group call in a group you're a member of.",[i.param('caller name',y.name)])),c('React').createElement(c('Facepile.react'),{moreCount:Math.max(0,z.length-n),profiles:z.map(function(aa){var ba=aa.name,ca=aa.fbid,da=aa.big_image_src;return {name:ba,uniqueID:ca,profilePicURI:da};}).slice(0,n),size:'medium'}),c('React').createElement('div',{className:"_2n1t"},x?i._("Video will start as soon as you answer."):i._("The call will start as soon as you answer.")))));},s=function v(w){c('messengerDialogsRe').removeAllDialogs();w();},t=function v(w){c('messengerDialogsRe').removeAllDialogs();w();},u=function v(w,x){if(!w){c('messengerDialogsRe').removeAllDialogs();x();}};p.propTypes={caller:l.instanceOf(c('ImmutableObject')).isRequired,callees:l.arrayOf(l.instanceOf(c('ImmutableObject'))).isRequired,hasVideo:l.bool.isRequired,onAnswer:l.func.isRequired,onIgnore:l.func.isRequired};f.exports=p;}),null);
__d("MediaStream",[],(function a(b,c,d,e,f,g){f.exports=window.MediaStream||window.webkitMediaStream;}),null);
__d('RTCAudioTrackNoiseDetector',['invariant','Promise','MediaStream'],(function a(b,c,d,e,f,g,h){'use strict';var i='audio track with absolute silence',j='audio track data timeout',k='wrong track type, expected "audio"',l=100,m={ABSOLUTE_SILENCE_ERROR:i,DATA_TIMEOUT_ERROR:j,WRONG_TRACK_TYPE_ERROR:k,detect:function n(o,p){if('kind' in o&&o.kind!=='audio')return c('Promise').reject(new Error(k));var q=new (c('MediaStream'))();q.addTrack(o);var r=new AudioContext(),s=r.createMediaStreamSource(q),t=r.createScriptProcessor(0,1,1),u=l,v=function w(){t!=null||h(0);t.onaudioprocess=null;t.disconnect();t=null;s!=null||h(0);s.disconnect();s=null;q!=null||h(0);q.removeTrack(o);q=null;r!=null||h(0);return c('Promise').resolve(r.close())['catch'](function(){return c('Promise').resolve();}).then(function(){r=null;});};return c('Promise').race([new (c('Promise'))(function(w,x){t!=null||h(0);t.onaudioprocess=function(y){var z=y.inputBuffer;for(var aa=z.getChannelData(0),ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da;if(ba){if(ca>=aa.length)break;da=aa[ca++];}else{ca=aa.next();if(ca.done)break;da=ca.value;}var ea=da;if(ea!==0){w();return;}}if(u>0){u--;}else x(new Error(i));};s!=null||h(0);s.connect(t);r!=null||h(0);t.connect(r.destination);}),new (c('Promise'))(function(w){return setTimeout(w,p);}).then(function(){throw new Error(j);})]).then(function(){return v();})['catch'](function(w){return v().then(function(){throw w;});});}};f.exports=m;}),null);
__d('RTCEndCallReason',['fbt','FBRTCConstants','MultiwayTypes'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('FBRTCConstants').CallEndReason,j=c('FBRTCConstants').CollabCallEndSubreason,k=c('MultiwayTypes').DismissReason,l=c('MultiwayTypes').HangupReason,m=c('MultiwayTypes').RtcResponseStatusCode;function n(o){this.$RTCEndCallReason1=-1;this.$RTCEndCallReason3='local';this.$RTCEndCallReason4=false;if(typeof o==='string'||o instanceof String){this.$RTCEndCallReason1=i.strNames.indexOf(o);}else this.$RTCEndCallReason1=o;}n.prototype.setSubreason=function(o){this.$RTCEndCallReason2=o;return this;};n.prototype.getSubreason=function(){return this.$RTCEndCallReason2;};n.prototype.setRemoteEnded=function(o){this.$RTCEndCallReason3=o?'remote':'local';return this;};n.prototype.toStrName=function(){var o=arguments.length<=0||arguments[0]===undefined?true:arguments[0];return o?this.$RTCEndCallReason5()+'_'+this.$RTCEndCallReason3:this.$RTCEndCallReason5();};n.prototype.$RTCEndCallReason5=function(){if(this.$RTCEndCallReason1<0||this.$RTCEndCallReason1>i.strNames.length)return 'Unknown';return i.strNames[this.$RTCEndCallReason1];};n.prototype.getReasonID=function(){return this.$RTCEndCallReason1;};n.prototype.toString=function(){var o=arguments.length<=0||arguments[0]===undefined?false:arguments[0],p=(this.$RTCEndCallReason6()||'').toString();return o?p+' '+this.$RTCEndCallReason7():p;};n.prototype.$RTCEndCallReason6=function(){switch(this.$RTCEndCallReason1){case i.NO_ANSWER_TIMEOUT:case i.IGNORE_CALL:return h._("No Answer");case i.OTHER_NOT_CAPABLE:if(this.$RTCEndCallReason2===j.MCU_INVALID_STREAM_CONFIGURATION)return h._("Too many clients connected to the room");case i.INCOMING_TIMEOUT:case i.NO_PERMISSION:case i.OTHER_CARRIER_BLOCKED:return h._("Not Reachable");case i.SIGNALING_MESSAGE_FAILED:case i.WEBRTC_ERROR:case i.NO_UI_ERROR:case i.CALLER_NOT_VISIBLE:case i.CLIENT_ERROR:return h._("Call Failed");case i.UNSUPPORTED_VERSION:return h._("Can't connect Call");case i.IN_ANOTHER_CALL:return h._("On Another Call");case i.CARRIER_BLOCKED:return h._("Switch to Wi-Fi to complete your call");case i.CLIENT_INTERRUPTED:return h._("Call Interrupted");case i.HANGUP_CALL:case i.ACCEPT_AFTER_HANGUP:return h._("Call ended");case i.CONNECTION_DROPPED:return h._("Connection lost");case i.OTHER_INSTANCE_HANDLED:return null;default:return null;}};n.prototype.$RTCEndCallReason7=function(){if(this.$RTCEndCallReason1!==i.OTHER_NOT_CAPABLE&&this.$RTCEndCallReason1!==i.SIGNALING_MESSAGE_FAILED)return '';switch(this.$RTCEndCallReason2){case j.REMOTE_PEER_HANGUP:case j.REMOTE_PEER_REJECT:return '';case j.CLOSED_BY_MCU:return '- Call expired';case j.CLOSED_AS_STALE:return '- Server failed, call is stale';case j.CALL_INITIALIZATION_FAILED:return '- Call initialization to room failed';case j.SIP_CONNECTION_INITIALIZATION_FAILED:return 'or No Answer';case j.LOST_MCU_CONNECTION:return '- MCU Media connection failed';case j.LOST_MCU_THRIFT_CONNECTION:return '- MCU infrastructure dropped connection';case j.LOST_SIP_ADAPTER_CONNECTION:return '- SIP infrastructure dropped connection';case j.MCU_NO_AUDIO_STREAM:return '- Invalid audio stream';case j.MCU_INVALID_STREAM_CONFIGURATION:return '- Invalid stream configuration';case j.UNKNOWN:default:return '- Unexpected call failure: '+(this.$RTCEndCallReason2||'null');}};n.fromHangupReason=function(o){switch(o){case l.IGNORE_CALL:return new n(i.IGNORE_CALL);case l.NO_ANSWER_TIMEOUT:return new n(i.NO_ANSWER_TIMEOUT);case l.HANGUP_CALL:return new n(i.HANGUP_CALL);case l.CLIENT_ERROR:return new n(i.CLIENT_ERROR);case l.IN_ANOTHER_CALL:return new n(i.IN_ANOTHER_CALL);case l.CLIENT_INTERRUPTED:return new n(i.CLIENT_INTERRUPTED);default:return new n(i.HANGUP_CALL);}};n.fromDismissRequest=function(o){if(!o)return new n(i.HANGUP_CALL);switch(o.reason){case k.ANSWERED_ON_ANOTHER_DEVICE:case k.REJECTED_ON_ANOTHER_DEVICE:return new n(i.OTHER_INSTANCE_HANDLED);case k.CALL_ENDED:return new n(i.HANGUP_CALL);case k.IN_ANOTHER_CALL:return new n(i.IN_ANOTHER_CALL);case k.CONNECTION_DROPPED:return new n(i.CONNECTION_DROPPED);case k.REMOVED_BY_PARTICIPANT:return new n(i.HANGUP_CALL);case k.REJECTED_BY_CALLEE:return new n(i.IGNORE_CALL);case k.INTERNAL_ERROR:return new n(i.SIGNALING_MESSAGE_FAILED);default:return new n(i.HANGUP_CALL);}};n.fromResponseStatusCode=function(o){switch(o){case m.PRECONDITION_FAILURE:case m.METHOD_NOT_ALLOWED:case m.UNAUTHORIZED:return new n(i.NO_PERMISSION);case m.SERVICE_UNAVAILABLE:return new n(i.SIGNALING_MESSAGE_FAILED);case m.SERVER_INTERNAL_ERROR:case m.BAD_REQUEST:case m.BUSY_HERE:case m.CONDITIONAL_REQUEST_FAILED:case m.NOT_FOUND:return new n(i.CLIENT_ERROR);default:return new n(i.HANGUP_CALL);}};f.exports=n;}),null);
__d('RTCVideoTrackActivityDetector',['invariant','Promise','MediaStream'],(function a(b,c,d,e,f,g,h){'use strict';var i=window.URL||window.webkitURL,j=HTMLMediaElement&&'srcObject' in HTMLMediaElement.prototype,k='video track playback timeout',l='unexpected video track ready state',m='wrong track type, expected "video"',n={PLAYBACK_TIMEOUT_ERROR:k,WRONG_READY_STATE_ERROR:l,WRONG_TRACK_TYPE_ERROR:m,detect:function o(p,q){if('kind' in p&&p.kind!=='video')return c('Promise').reject(new Error(m));var r=document.createElement('video');r.muted=true;var s=new (c('MediaStream'))();s.addTrack(p);var t=void 0,u=0,v=function w(){clearInterval(u);if(r){r.pause();if(j){r.srcObject=null;}else if(r.src){i.revokeObjectURL(r.src);r.src='';}r.removeEventListener('timeupdate',t);r=null;}if(s){s.removeTrack(p);s=null;}};return c('Promise').race([new (c('Promise'))(function(w,x){r!=null||h(0);if(j){r.srcObject=s;}else r.src=i.createObjectURL(s);t=function y(z){r!=null||h(0);if(r.currentTime>0)if(p.readyState==='live'){w();v();}else x(new Error(l));};c('Promise').resolve(r.pause()).then(function(){r!=null||h(0);return r.play();}).then(function(){t();r!=null||h(0);r.addEventListener('timeupdate',t);u=setInterval(t,50);})['catch'](function(y){return x(y);});}),new (c('Promise'))(function(w){return setTimeout(w,q);}).then(function(){throw new Error(k);})])['catch'](function(w){v();throw w;});}};f.exports=n;}),null);
__d('RTCMediaStreamValidator',['Promise','RTCAudioTrackNoiseDetector','RTCVideoTrackActivityDetector'],(function a(b,c,d,e,f,g){'use strict';var h='no audio tracks',i='no video tracks',j='too many audio tracks',k='too many video tracks',l='unexpected audio track(s)',m='unexpected video track(s)',n={NO_AUDIO_TRACKS_ERROR:h,NO_VIDEO_TRACKS_ERROR:i,TOO_MANY_AUDIO_TRACKS_ERROR:j,TOO_MANY_VIDEO_TRACKS_ERROR:k,UNEXPECTED_AUDIO_TRACKS_ERROR:l,UNEXPECTED_VIDEO_TRACKS_ERROR:m,validate:function q(r,s){var t=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],u=arguments.length<=3||arguments[3]===undefined?{}:arguments[3],v=t.audio,w=v===undefined?true:v,x=t.video,y=x===undefined?true:x,z=u.audio,aa=z===undefined?1000:z,ba=u.video,ca=ba===undefined?1000:ba;return c('Promise').all([o(r,s,w,aa),p(r,s,y,ca)]).then(function(){return r;});}};function o(q,r,s,t){var u=q.getAudioTracks();if(!r.audio)return u.length>0?c('Promise').reject(new Error(l)):c('Promise').resolve(q);if(u.length<1){return c('Promise').reject(new Error(h));}else if(u.length>1)return c('Promise').reject(new Error(j));return !s?c('Promise').resolve(q):c('RTCAudioTrackNoiseDetector').detect(u[0],t).then(function(){return q;});}function p(q,r,s,t){var u=q.getVideoTracks();if(!r.video)return u.length>0?c('Promise').reject(new Error(m)):c('Promise').resolve(q);if(u.length<1){return c('Promise').reject(new Error(i));}else if(u.length>1)return c('Promise').reject(new Error(k));return !s?c('Promise').resolve(q):c('RTCVideoTrackActivityDetector').detect(u[0],t).then(function(){return q;});}f.exports=n;}),null);
__d('RTCUserMediaConstraints',['FBRTCConstants','RTCConfig'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBRTCConstants').VideoQuality,i={width:1920,height:1080,frameRate:30},j={width:1280,height:720,frameRate:30},k={width:854,height:480,frameRate:30},l={width:320,height:180,frameRate:15},m={audio:function r(s){return s?{deviceId:s}:true;},video:function r(s,t){var u=arguments.length<=2||arguments[2]===undefined?c('RTCConfig').CollaborationCallQuality.videoToRoom:arguments[2];if(s===h.NO_VIDEO)return false;var v=t?{deviceId:t}:null;if(s===h.CUSTOM_VIDEO)return babelHelpers['extends']({},u,v);var w=n(s);return babelHelpers['extends']({width:o(w,'width'),height:o(w,'height'),frameRate:o(w,'frameRate')},v);},chromeMediaSource:function r(s,t){var u=s.video,v=m.chromify(u);if(typeof v!=='object')return {audio:false,video:Boolean(v)};var w=v.mandatory,x=v.optional,y=x===undefined?[]:x;return {audio:false,video:{mandatory:babelHelpers['extends']({},w,{chromeMediaSource:'desktop',chromeMediaSourceId:t}),optional:[{googTemporalLayeredScreencast:true}].concat(y)}};},chromify:function r(s){if(!s||typeof s!=='object')return Boolean(s);if(!q(s))return s;var t=s.mandatory,u=t===undefined?{}:t,v=s.optional,w=v===undefined?[]:v;for(var x=Object.entries(s),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var aa;if(y){if(z>=x.length)break;aa=x[z++];}else{z=x.next();if(z.done)break;aa=z.value;}var ba=aa,ca=ba[0],da=ba[1];if(ca==='require'||ca==='advanced'||ca==='mediaSource')continue;var ea=da&&typeof da==='object'?da:{ideal:da};if(Number.isFinite(ea.exact)){ea.min=ea.exact;ea.max=ea.exact;}var fa=ea.ideal,ga=ea.exact;if(fa!==undefined)if(Number.isFinite(fa)){var ha,ia;w.push((ha={},ha[p(ca,'min')]=fa,ha),(ia={},ia[p(ca,'max')]=fa,ia));}else{var ja;w.push((ja={},ja[p(ca)]=fa,ja));}if(ga!==undefined&&!Number.isFinite(ga)){u[p(ca)]=ga;}else{var ka=['min','max'];for(var la=0;la<ka.length;la++){var ma=ka[la];if(Number.isFinite(ea[ma]))u[p(ca,ma)]=ea[ma];}}}if(s.advanced)w.push.apply(w,s.advanced);var na={};if(Object.keys(u).length>0)na.mandatory=u;if(w.length>0)na.optional=w;return na;}};function n(r){switch(r){case h.FHD_VIDEO:return i;case h.HD_VIDEO:return j;case h.LQ_VIDEO:return l;case h.SD_VIDEO:return k;default:return j;}}function o(r,s){var t=r[s];return {min:Math.min(l[s],t),max:Math.max(i[s],t),ideal:t};}function p(r,s){if(s)return ''+s+r.charAt(0).toUpperCase()+r.slice(1);return r==='deviceId'?'sourceId':r;}function q(r){return Object.keys(r).some(function(s){return s!=='mandatory'&&s!=='optional';});}f.exports=m;}),null);
__d('RTCUtils',['Promise','CurrentUser','RTCAudioTrackNoiseDetector','RTCVideoTrackActivityDetector','FBRTCUtils','RTCConfig','RTCEndCallReason','RTCMediaStreamValidator','RTCScreenSharing','RTCUserMediaConstraints','UserAgent','FBRTCConstants','randomInt'],(function a(b,c,d,e,f,g){'use strict';var h=c('RTCAudioTrackNoiseDetector').DATA_TIMEOUT_ERROR,i=c('RTCVideoTrackActivityDetector').PLAYBACK_TIMEOUT_ERROR,j=c('FBRTCConstants').VideoQuality,k={generateRandomInt:function l(){return c('randomInt')(0,4294967294)+1;},isGroupCall:function l(m){return m.split(':')[0]==='GROUP';},isMessengerCall:function l(m){return m.split(':')[0]==='MESSENGER';},isPartiesCall:function l(m){return m.split(':')[0]==='BONFIRE';},getPeerID:function l(m){if(this.isGroupCall(m))throw new Error('Not a P2P call: '+m);var n=m.split(':'),o=n.slice(1);return o[0]===c('CurrentUser').getID()?o[1]:o[0];},createRequestHeader:function l(m,n,o){var p={type:m,transactionId:k.generateRandomInt().toString(),retryCount:0,conferenceName:n};if(o)p.serverInfoData=o;return p;},createResponseHeader:function l(m,n){var o={type:m.type,transactionId:m.transactionId,retryCount:0,conferenceName:m.conferenceName,responseStatusCode:n};if(m.serverInfoData)o.serverInfoData=m.serverInfoData;return o;},getUserMedia:function l(m){var n=navigator,o=n.mediaDevices;if(typeof m.video==='object'&&m.video.mediaSource)return c('RTCScreenSharing').getUserMedia(m);var p=this._parseConstraints(m);return new (c('Promise'))(function(q,r){if(o&&typeof o.getUserMedia==='function'){q(o.getUserMedia(p));}else if(navigator.getUserMedia){navigator.getUserMedia(p,q,r);}else if(navigator.webkitGetUserMedia){navigator.webkitGetUserMedia(p,q,r);}else if(navigator.mozGetUserMedia){navigator.mozGetUserMedia(p,q,r);}else if(navigator.msGetUserMedia){navigator.msGetUserMedia(p,q,r);}else r('getUserMedia not supported');})['catch'](function(q){throw this._shimError(q);}.bind(this));},_parseConstraints:function l(m){if(c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera')){var n=m.audio,o=m.video,p={};if(n!=undefined)p.audio=c('RTCUserMediaConstraints').chromify(n);if(o!=undefined)p.video=c('RTCUserMediaConstraints').chromify(o);return p;}return m;},getUserMediaWithValidation:function l(m){var n=arguments.length<=1||arguments[1]===undefined?{audio:true,video:true}:arguments[1],o=arguments.length<=2||arguments[2]===undefined?5:arguments[2],p=arguments.length<=3||arguments[3]===undefined?{audio:1000,video:1000}:arguments[3];return new (c('Promise'))(function(q,r){var s=function(t){this.getUserMedia(m).then(function(u){return c('RTCMediaStreamValidator').validate(u,m,n,p).then(function(v){return q({stream:v});})['catch'](function(v){if(v.message===h||v.message===i){q({stream:u,err:v});}else{this.stopMediaStream(u);throw v;}}.bind(this));}.bind(this),r)['catch'](function(u){if(t>0){s(t-1);}else r(u);});}.bind(this);s(o);}.bind(this));},initLocalStream:function l(m){return k.getUserMedia({audio:c('RTCUserMediaConstraints').audio(),video:c('RTCUserMediaConstraints').video(m?j.HD_VIDEO:j.NO_VIDEO)});},initLocalScreenStream:function l(){var m=arguments.length<=0||arguments[0]===undefined?'screen':arguments[0];return k.getUserMedia({audio:false,video:babelHelpers['extends']({},c('RTCConfig').CollaborationCallQuality.screen_v2||c('RTCConfig').CollaborationCallQuality.screen,{mediaSource:m})});},isFullScreen:function l(){return !!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);},requestFullScreen:function l(){var m=arguments.length<=0||arguments[0]===undefined?document.documentElement:arguments[0];if(typeof m.requestFullscreen==='function'){m.requestFullscreen();}else if(typeof m.msRequestFullscreen==='function'){m.msRequestFullscreen();}else if(typeof m.mozRequestFullScreen==='function'){m.mozRequestFullScreen();}else if(typeof m.webkitRequestFullscreen==='function')m.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);},exitFullScreen:function l(){if(typeof document.exitFullscreen==='function'){document.exitFullscreen();}else if(typeof document.msExitFullscreen==='function'){document.msExitFullscreen();}else if(typeof document.mozCancelFullScreen==='function'){document.mozCancelFullScreen();}else if(typeof document.webkitExitFullscreen==='function')document.webkitExitFullscreen();},toggleFullScreen:function l(){if(this.isFullScreen()){this.exitFullScreen();}else this.requestFullScreen();},endCallReasonFromHangupReason:function l(m){return c('RTCEndCallReason').fromHangupReason(m).getReasonID();},endCallReasonFromDismissRequest:function l(m){return c('RTCEndCallReason').fromDismissRequest(m).getReasonID();},endCallReasonFromResponseStatusCode:function l(m){return c('RTCEndCallReason').fromResponseStatusCode(m).getReasonID();},stopMediaStream:function l(m){if(!m.active&&'active' in m)return;for(var n=m.getTracks(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q;if(r.readyState!=='ended')r.stop();}},getStreamVideoResolution:function l(m){return new (c('Promise'))(function(n,o){var p=document.createElement('video');c('FBRTCUtils').attachMediaStream(p,m);var q=function t(){p.removeEventListener('loadedmetadata',r);p.removeEventListener('error',s);c('FBRTCUtils').attachMediaStream(p,null);},r=function t(){n({width:p.videoWidth,height:p.videoHeight});q();},s=function t(){o(p.error);q();};p.addEventListener('loadedmetadata',r);p.addEventListener('error',s);});},_shimError:function l(m){var n=m.message,o=m.name,p=new Error(n==='The operation is insecure.'?'The request is not allowed by the user agent or the platform in the'+'current context.':n);p.name={ConstraintNotSatisfiedError:'OverconstrainedError',NotSupportedError:'TypeError',PermissionDeniedError:'NotAllowedError',SecurityError:'NotAllowedError'}[o]||o;return p;}};f.exports=k;}),null);
__d('MessengerRTCGroupCallIncomingDialogController',['EventEmitter','FBRTCSoundController','MercuryIDs','MercuryParticipants','messengerDialogsRe','MessengerRTCGroupCallIncomingDialog.react','MessengerRTCIncomingDialog.react','React','RTCUtils','XGroupCallController','randomInt','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=70000;h=babelHelpers.inherits(k,c('EventEmitter'));i=h&&h.prototype;function k(l,m,n,o,p,q){i.constructor.call(this);this.$MessengerRTCGroupCallIncomingDialogController1=l;this.$MessengerRTCGroupCallIncomingDialogController2=m;this.$MessengerRTCGroupCallIncomingDialogController3=n;this.$MessengerRTCGroupCallIncomingDialogController4=o;this.$MessengerRTCGroupCallIncomingDialogController5=p;this.$MessengerRTCGroupCallIncomingDialogController6=q;this.$MessengerRTCGroupCallIncomingDialogController7=null;}k.prototype.serverInfoData=function(){return this.$MessengerRTCGroupCallIncomingDialogController6;};k.prototype.showIncomingDialog=function(){this.$MessengerRTCGroupCallIncomingDialogController7=c('setTimeoutAcrossTransitions')(this.$MessengerRTCGroupCallIncomingDialogController8.bind(this),j);var l=this.$MessengerRTCGroupCallIncomingDialogController1+c('randomInt')(0,4294967295).toString();c('FBRTCSoundController').playIncomingRingtone(l,this.$MessengerRTCGroupCallIncomingDialogController1,true);if(!c('RTCUtils').isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1)){c('messengerDialogsRe').showDialog(function(){return c('React').createElement(c('MessengerRTCIncomingDialog.react'),{callerID:this.$MessengerRTCGroupCallIncomingDialogController3,isVideoCall:this.$MessengerRTCGroupCallIncomingDialogController5,onAccept:function(){return this.$MessengerRTCGroupCallIncomingDialogController9();}.bind(this),onDecline:function(){return this.$MessengerRTCGroupCallIncomingDialogController10();}.bind(this)});}.bind(this));return;}var m=[this.$MessengerRTCGroupCallIncomingDialogController3].concat(this.$MessengerRTCGroupCallIncomingDialogController4);c('MercuryParticipants').getMulti(m.map(c('MercuryIDs').getParticipantIDFromUserID),function(n){return c('messengerDialogsRe').showDialog(function(){return c('React').createElement(c('MessengerRTCGroupCallIncomingDialog.react'),{caller:n[c('MercuryIDs').getParticipantIDFromUserID(this.$MessengerRTCGroupCallIncomingDialogController3)],callees:Object.values(n).filter(function(o){var p=o.fbid;return p!==this.$MessengerRTCGroupCallIncomingDialogController3;}.bind(this)),hasVideo:this.$MessengerRTCGroupCallIncomingDialogController5,onAnswer:function(){return this.$MessengerRTCGroupCallIncomingDialogController9();}.bind(this),onIgnore:function(){return this.$MessengerRTCGroupCallIncomingDialogController10();}.bind(this)});}.bind(this));}.bind(this));};k.prototype.cancel=function(){if(this.$MessengerRTCGroupCallIncomingDialogController7)clearTimeout(this.$MessengerRTCGroupCallIncomingDialogController7);c('messengerDialogsRe').removeAllDialogs();c('FBRTCSoundController').stopIncomingRingtone();};k.prototype.$MessengerRTCGroupCallIncomingDialogController9=function(){this.cancel();var l=c('XGroupCallController').getURIBuilder().setString('conference_name',this.$MessengerRTCGroupCallIncomingDialogController1).setInt('call_id',this.$MessengerRTCGroupCallIncomingDialogController2).setBool('has_video',this.$MessengerRTCGroupCallIncomingDialogController5).setString('server_info_data',this.$MessengerRTCGroupCallIncomingDialogController6).getURI();this.emit('answerCall',this.$MessengerRTCGroupCallIncomingDialogController1,l);};k.prototype.$MessengerRTCGroupCallIncomingDialogController10=function(){this.cancel();this.emit('ignoreCall');};k.prototype.$MessengerRTCGroupCallIncomingDialogController8=function(){this.cancel();this.emit('timeout');};f.exports=k;}),null);
__d('MessengerRTCGroupCallRingParticipantsRow.react',['cx','fbt','React','intlList'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=function k(l){var m=l.names;return c('React').createElement('div',{className:"_1wsd"},c('React').createElement('div',{className:"_1wse"},i._("Ring:")),c('React').createElement('div',{className:"_1wsg"},c('intlList')(m,c('intlList').CONJUNCTIONS.NONE)));};f.exports=j;}),null);
__d('MercuryParticipantListRenderer',['fbt','MercuryIDs'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$MercuryParticipantListRenderer6=function(s){var t=this.$MercuryParticipantListRenderer5;if(t){var u=c('MercuryIDs').getUserIDFromParticipantID(s.id);if(u&&t[u])return t[u];}return this.$MercuryParticipantListRenderer2?s.short_name:s.name;}.bind(this);this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=false;this.$MercuryParticipantListRenderer4=0;this.$MercuryParticipantListRenderer5=null;}i.prototype.renderParticipantList=function(s){var t=s.map(this.$MercuryParticipantListRenderer6);switch(t.length){case 0:return j(this.$MercuryParticipantListRenderer1);case 1:return k(t);case 2:return this.$MercuryParticipantListRenderer3?m(t):l(t);case 3:return this.$MercuryParticipantListRenderer3?o(t):n(t);default:return this.$MercuryParticipantListRenderer3?q(t,this.$MercuryParticipantListRenderer4):p(t,this.$MercuryParticipantListRenderer4);}};i.prototype.setIsNewThread=function(s){this.$MercuryParticipantListRenderer1=s;return this;};i.prototype.setNameRenderer=function(s){this.$MercuryParticipantListRenderer6=s;return this;};i.prototype.setUseShortName=function(s){this.$MercuryParticipantListRenderer2=s;return this;};i.prototype.setNickname=function(s){this.$MercuryParticipantListRenderer5=s;return this;};i.prototype.setUseAndSeparator=function(s){this.$MercuryParticipantListRenderer3=s;return this;};i.prototype.setTotalParticipantCount=function(s){this.$MercuryParticipantListRenderer4=s;return this;};function j(s){if(s){return h._("New message");}else return h._("No Participants");}function k(s){return s[0];}function l(s){return h._("{participant1}, {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function m(s){return h._("{participant1} and {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function n(s){return h._("{participant1}, {participant2}, {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function o(s){return h._("{participant1}, {participant2}  and {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function p(s,t){return h._("{participant1}, {participant2}, {participant3}, {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2]),h.param('others_link',r((t||s.length)-3))]);}function q(s,t){return h._("{participant1}, {participant2} and {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('others_link',r((t||s.length)-2))]);}function r(s){if(s>1){return h._({"*":"{others_count} others"},[h.param('others_count',s,[0])]);}else return h._("1 other");}f.exports=i;}),null);
__d('MercuryThreadTitle.react',['fbt','MercuryIDs','MessengerTextWithEmoticons.react','MercuryParticipantListRenderer','MercuryParticipants','React','TextWithEmoticons.react'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=c('React').createClass({displayName:'MercuryThreadTitle',propTypes:{isNewThread:i.bool,thread:i.object.isRequired,viewer:i.string.isRequired,showUnreadCount:i.bool,useShortName:i.bool,useAndSeparator:i.bool},getDefaultProps:function k(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function k(){return {participantNames:''};},componentDidMount:function k(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function k(l){this._renderParticipantsList(l);},render:function k(){return c('React').createElement('span',{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children);},getTitle:function k(){return this.state.participantNames;},_renderThreadTitle:function k(){var l=this.props.thread,m=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:l.name});if(!l.unread_count||!this.props.showUnreadCount)return m;return this._renderTitleWithUnreadCount(m,l.unread_count);},_renderParticipantsList:function k(l){if(l.thread.name)return;this.setState({participantNames:''});var m=c('MercuryIDs').getParticipantIDFromUserID(l.viewer),n=l.thread.participants||[];if(n.length>1)n=n.filter(function(o){return o!=m;});c('MercuryParticipants').getMulti(n,function(o){if(!this.isMounted())return;var p=n.map(function(v){return o[v];}),q=l.thread.custom_nickname?{}:null,r=c('MessengerTextWithEmoticons.react');if(q)for(var s in l.thread.custom_nickname)q[s]=c('React').createElement(r,{renderEmoticons:true,renderEmoji:true,text:l.thread.custom_nickname[s]});var t=new (c('MercuryParticipantListRenderer'))().setUseShortName(l.useShortName).setUseAndSeparator(l.useAndSeparator).setIsNewThread(l.isNewThread).setNickname(q).renderParticipantList(p),u=l.showUnreadCount&&l.thread.unread_count?this._renderTitleWithUnreadCount(t,l.thread.unread_count):t;this.setState({participantNames:u});}.bind(this));},_renderTitleWithUnreadCount:function k(l,m){return h._("{conversation-title} ({unread-count})",[h.param('conversation-title',l),h.param('unread-count',m)]);}});f.exports=j;}),null);
__d('RTCCallTitle.react',['immutable','MercuryIDs','MercuryParticipantListRenderer','React'],(function a(b,c,d,e,f,g){'use strict';var h=function i(j){var k=j.viewer,l=j.participants,m=j.className,n=c('MercuryIDs').getParticipantIDFromUserID(k),o=Object.keys(l.toJS());if(o.length>1)o=o.filter(function(r){return r!=n;});var p=o.map(function(r){return l.get(r);}),q=new (c('MercuryParticipantListRenderer'))().setUseShortName(false).setUseAndSeparator(false).renderParticipantList(p);return c('React').createElement('span',{className:m},q);};f.exports=h;}),null);
__d('MessengerRTCGroupCallThreadRow.react',['cx','fbt','MercuryParticipantsImage.react','MercuryThreadTitle.react','messengerProfileImageWrapperReact','messengerThreadImageReact','React','RTCCallTitle.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('messengerProfileImageWrapperReact').jsComponent,k=c('messengerThreadImageReact').jsComponent,l=function p(q){var r=q.displayAddMemberWarning,s=q.participants,t=q.thread,u=q.viewerID;return c('React').createElement('div',{className:"_5y31"},c('React').createElement(k,{className:"_5y32",participants:s,thread:t,viewer:u}),c('React').createElement('div',{className:"_5y34"},c('React').createElement(c('MercuryThreadTitle.react'),{className:"_5y37",thread:t,viewer:u}),c('React').createElement(n,{displayAddMemberWarning:r})));},m=function p(q){var r=q.displayAddMemberWarning,s=q.participants,t=q.thread,u=q.viewerID;return c('React').createElement('div',{className:"_5y31"},c('React').createElement(j,{className:"_5y32",showBadge:false,size:50},c('React').createElement(c('MercuryParticipantsImage.react'),{participants:Object.keys(s.toJS())})),c('React').createElement('div',{className:"_5y34"},c('React').createElement(c('RTCCallTitle.react'),{className:"_5y37",participants:s,viewer:u}),c('React').createElement(n,{displayAddMemberWarning:r})));},n=function p(q){var r=q.displayAddMemberWarning;return r?c('React').createElement('div',{className:"_1apf"},i._("People you add to this group video will see previous messages in this conversation.")):null;},o=function p(q){var r=q.thread,s=babelHelpers.objectWithoutProperties(q,['thread']);return r?c('React').createElement(l,babelHelpers['extends']({thread:r},s)):c('React').createElement(m,babelHelpers['extends']({thread:r},s));};f.exports=o;}),null);
__d('MessengerRTCGroupCallUnsupportedBrowserDialog.react',['fbt','Link.react','MessengerDialog.react','messengerDialogBodyReact','MessengerDialogButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','React','UserAgent'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('messengerDialogBodyReact').jsComponent,j=function n(o){var p=o.hasVideo,q=o.onUnmount;return c('React').createElement(c('MessengerDialog.react'),{onToggle:q},c('React').createElement(c('MessengerDialogHeader.react'),null,k(p)),c('React').createElement(i,null,l(p)),c('React').createElement(c('MessengerDialogFooter.react'),null,c('React').createElement(c('MessengerDialogButton.react'),{label:h._("OK"),onClick:q,type:'primary'})));};function k(n){return n?h._("Switch Browsers to Make Group Video Chats"):h._("Switch browsers to make group calls");}function l(n){return n?h._("Unfortunately, our group calling feature doesn't support {browser name, i.e. Internet Explorer or Safari} yet. To make a group video chat, open in {link to install chrome}.",[h.param('browser name, i.e. Internet Explorer or Safari',m()),h.param('link to install chrome',c('React').createElement(c('Link.react'),{href:'https://www.google.com/chrome/index.html',target:'_blank'},'Google Chrome'))]):h._("Unfortunately, our group calling feature doesn't support {browser name, i.e. Internet Explorer or Safari} yet. To make a group call, open in {link to install chrome}.",[h.param('browser name, i.e. Internet Explorer or Safari',m()),h.param('link to install chrome',c('React').createElement(c('Link.react'),{href:'https://www.google.com/chrome/index.html',target:'_blank'},'Google Chrome'))]);}function m(){if(c('UserAgent').isBrowser('Firefox')){return h._("Firefox");}else if(c('UserAgent').isBrowser('IE')){return h._("Internet Explorer");}else if(c('UserAgent').isBrowser('Safari')){return h._("Safari");}else return h._("your browser");}f.exports=j;}),null);
__d('MessengerRTCGroupCallUnsupportedBrowserDialogController',['DOM','MessengerRTCGroupCallUnsupportedBrowserDialog.react','React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';var h={_container:c('DOM').create('div'),render:function i(j){var k=j.hasVideo;c('ReactDOM').render(c('React').createElement(c('MessengerRTCGroupCallUnsupportedBrowserDialog.react'),{hasVideo:k,onUnmount:function(){return this.unmount();}.bind(this)}),this._container);},unmount:function i(){c('ReactDOM').unmountComponentAtNode(this._container);}};f.exports=h;}),null);
__d('FBRTCMultiwayMessage',['CurrentUser','ChannelManager','RTCUtils','MultiwayTypes'],(function a(b,c,d,e,f,g){var h=c('MultiwayTypes').MessageType;c('ChannelManager').startChannelManager();function i(j){'use strict';this.$FBRTCMultiwayMessage1=j;}i.prototype.isRequest=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.header.responseStatusCode==null;};i.prototype.isType=function(j){'use strict';return this.header().type==j;};i.prototype.transactionId=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.header.transactionId;};i.prototype.conferenceName=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.header.conferenceName;};i.prototype.serverInfoData=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.header.serverInfoData;};i.prototype.message=function(){'use strict';return this.$FBRTCMultiwayMessage1;};i.prototype.endpoint=function(){'use strict';return this.$FBRTCMultiwayMessage1.endpoint;};i.prototype.header=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.header;};i.prototype.body=function(){'use strict';return this.$FBRTCMultiwayMessage1.jsonPayload.body;};i.prototype.incrementRetryCount=function(){'use strict';this.$FBRTCMultiwayMessage1.jsonPayload.header.retryCount++;};i.prototype.ringRequest=function(){'use strict';return this.isRequest()&&this.isType(h.RING)?this.body().ringRequest:null;};i.prototype.dismissRequest=function(){'use strict';return this.isRequest()&&this.isType(h.DISMISS)?this.body().dismissRequest:null;};i.prototype.serverMediaUpdateRequest=function(){'use strict';return this.isRequest()&&this.isType(h.SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null;};i.prototype.conferenceStateRequest=function(){'use strict';return this.isRequest()&&this.isType(h.CONFERENCE_STATE)?this.body().conferenceStateRequest:null;};i.prototype.createResponse=function(j,k){'use strict';var l={endpoint:{appId:'229895473858072',deviceId:c('ChannelManager').getCompleteConfig().sessionID,userId:c('CurrentUser').getID()},jsonPayload:{header:c('RTCUtils').createResponseHeader(this.header(),j),body:k||{}}};return new i(l);};f.exports=i;}),null);
__d("XGroupCallSendMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/groupcall\/sendmessage\/",{webrtc_fbtrace:{type:"Int"}});}),null);
__d('RTCMessageSender',['Promise','CurrentUser','XGroupCallSendMessageController','SiteData','Fbtrace','AsyncRequest'],(function a(b,c,d,e,f,g){var h=6000;function i(){'use strict';}i.prototype.send=function(j){'use strict';return new (c('Promise'))(function(k,l){var m=j.jsonPayload.header.conferenceName,n={conference_name:m,user_id:c('CurrentUser').getID(),message:j,app_id:256281040558,app_version:String(c('SiteData').client_revision||'dev'),op:'RTCMessageSender.send',policy:'WebRTC'},o=c('Fbtrace').requestReceive('browser',String(c('SiteData').client_revision||'dev'),n),p=c('XGroupCallSendMessageController').getURIBuilder().setInt('webrtc_fbtrace',o.isOn()?1:0).getURI();c('Fbtrace').withDefaultNode(o,function(){var q=new (c('AsyncRequest'))(p).setMethod('POST').setData({message:JSON.stringify(j)}).setAllowCrossPageTransition(true).setHandler(function(r){k(r);}).setErrorHandler(function(r){var s=Error(r.getErrorDescription?r.getErrorDescription():'AsyncRequest error');l(s);}).setTimeoutHandler(h,function(){l('Timeout');});q.send();});});};f.exports=i;}),null);
__d('FBRTCTransactions',['Promise','Map','RTCMessageSender'],(function a(b,c,d,e,f,g){'use strict';var h=60000,i={INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3};function j(){this.$FBRTCTransactionOwner1=new (c('Map'))();}j.prototype.findTransaction=function(l){return this.$FBRTCTransactionOwner1.get(l);};j.prototype.addTransaction=function(l){this.$FBRTCTransactionOwner1.set(l.id,l);};j.prototype.removeTransaction=function(l){this.$FBRTCTransactionOwner1['delete'](l.id);};j.prototype.getTransaction=function(l){return this.findTransaction(l.transactionId())||new k(this,l);};function k(l,m){this.id=m.transactionId();this.$FBRTCServerTransaction1=i.INIT;this.$FBRTCServerTransaction2=m;this.$FBRTCServerTransaction3=null;this.$FBRTCServerTransaction4=l;this.$FBRTCServerTransaction5=new Error('Unknown');this.$FBRTCServerTransaction6=null;this.$FBRTCServerTransaction7=new (c('RTCMessageSender'))();this.$FBRTCServerTransaction8();this.$FBRTCServerTransaction4.addTransaction(this);}k.prototype.start=function(){if(this.$FBRTCServerTransaction1==i.INIT){this.$FBRTCServerTransaction9(i.PROCESSING);return c('Promise').resolve(this.$FBRTCServerTransaction2);}else if(this.$FBRTCServerTransaction1==i.PROCESSING){return c('Promise').resolve(null);}else if(this.$FBRTCServerTransaction1==i.COMPLETED){this.$FBRTCServerTransaction10();return c('Promise').resolve(null);}return c('Promise').reject(this.$FBRTCServerTransaction5);};k.prototype.sendResponse=function(l){this.$FBRTCServerTransaction3=l;this.$FBRTCServerTransaction9(i.COMPLETED);return this.$FBRTCServerTransaction7.send(l.message()).then(function(m){},function(m){this.$FBRTCServerTransaction5=m;this.$FBRTCServerTransaction9(i.TERMINATED);}.bind(this));};k.prototype.$FBRTCServerTransaction10=function(){if(this.$FBRTCServerTransaction3!=null){var l=this.$FBRTCServerTransaction3;l.incrementRetryCount();this.sendResponse(l);}};k.prototype.$FBRTCServerTransaction9=function(l){if(l!=this.$FBRTCServerTransaction1){this.$FBRTCServerTransaction1=l;if(this.$FBRTCServerTransaction1!=i.TERMINATED)this.$FBRTCServerTransaction8();if(this.$FBRTCServerTransaction1==i.TERMINATED){this.$FBRTCServerTransaction5=new Error('Terminated');this.$FBRTCServerTransaction4.removeTransaction(this);}}};k.prototype.$FBRTCServerTransaction8=function(){if(this.$FBRTCServerTransaction6){clearTimeout(this.$FBRTCServerTransaction6);this.$FBRTCServerTransaction6=null;}this.$FBRTCServerTransaction6=setTimeout(function(){this.$FBRTCServerTransaction9(i.TERMINATED);}.bind(this),h);};f.exports={FBRTCTransactionOwner:j,FBRTCServerTransaction:k};}),null);
__d('RTCGroupCallDialogController',['DOM','FBRTCGroupCallVideoEscalationDialog.react','React','ReactDOM','RTCGroupCallAddGroupMembersDialog.react','RTCGroupCallAddMembersDialog.react'],(function a(b,c,d,e,f,g){'use strict';var h={_container:c('DOM').create('div'),showAddGroupMembersDialog:function i(j,k,l,m){if(l){c('ReactDOM').render(c('React').createElement(c('RTCGroupCallAddMembersDialog.react'),{participants:j,participantStates:k,thread:l,viewerID:m,onUnmount:function(){return this._onUnmount();}.bind(this)}),this._container);}else c('ReactDOM').render(c('React').createElement(c('RTCGroupCallAddGroupMembersDialog.react'),{participants:j,participantStates:k,thread:l,viewerID:m,onUnmount:function(){return this._onUnmount();}.bind(this)}),this._container);},showVideoEscalationDialog:function i(j,k){c('ReactDOM').render(c('React').createElement(c('FBRTCGroupCallVideoEscalationDialog.react'),{userName:j,onToggle:function(){this._onUnmount();k();}.bind(this)}),this._container);},_onUnmount:function i(){c('ReactDOM').unmountComponentAtNode(this._container);}};f.exports=h;}),null);
__d('RTCConferenceState',[],(function a(b,c,d,e,f,g){'use strict';var h={NEW:'NEW',AWAITING_USER_START:'AWAITING_USER_START',CONNECTING:'CONNECTING',CONNECTED:'CONNECTED',TERMINATING:'TERMINATING',TERMINATED:'TERMINATED'};f.exports=h;}),null);
__d('FBRTCCallSummaryReducer',['FBRTCCallSummaryStore','FBRTCLogger','MultiwayTypes','RTCCallActionTypes','RTCCallStore','RTCConferenceState','RTCGroupCallActionTypes','RTCUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBRTCLogger').Key,i=c('MultiwayTypes').ParticipantCallState,j={setCallSummary:function k(l,m){switch(m.type){case c('RTCGroupCallActionTypes').SET_CALL_SUMMARY:return l.set('callSummary',m.callSummary);}return l;},setMWCallType:function k(l,m){switch(m.type){case c('RTCGroupCallActionTypes').SET_MW_CALL_TYPE:l.callSummary.setCallType(m.callType);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;}return l;},onCallStarted:function k(l,m){switch(m.type){case c('RTCCallActionTypes').INCOMING_CALL_SUCCESS:case c('RTCGroupCallActionTypes').CALL_SUCCESS:var n=function o(){var p=c('RTCCallStore').getState().callInfo.conferenceState;if(p!==c('RTCConferenceState').TERMINATED){l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());setTimeout(o,10000);}};n();return l;}return l;},onMessageSignaling:function k(l,m){switch(m.type){case c('RTCGroupCallActionTypes').ON_JOIN_REQUEST_SENT:if(l.callSummary.isCaller()){l.callSummary.setOfferSentTime();}else l.callSummary.setAnswerSentTime();l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').ON_JOIN_RESPONSE:if(!l.callSummary.isCaller()){l.callSummary.onCallConnected();l.callSummary.onNetworkReady();l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());}l.callSummary.setServerInfoData(m.serverInfoData);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').ON_SERVER_MEDIA_UPDATE_SUCCESS:if(l.callSummary.isCaller()){l.callSummary.setAnswerReceivedTime();if(l.callSummary.isNetworkReady())l.callSummary.onCallConnected();l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());}return l;case c('RTCGroupCallActionTypes').ON_CONFERENCE_STATE:var n=c('RTCCallStore').getState().callInfo.conferenceName;if(c('RTCUtils').isGroupCall(n)){l.callSummary.onNetworkReady();l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());}var o=m.request.conferenceStateRequest(),p=o.participantStates;Object.keys(p).forEach(function(q){if(q!==c('RTCCallStore').getState().localUser.getUserID())switch(p[q].state){case i.UNKNOWN:case i.CONTACTING:case i.UNREACHABLE:return;case i.CONNECTED:l.callSummary.onNetworkReady();if(l.callSummary.isAnswerReceived())l.callSummary.onCallConnected();default:if(l.callSummary.isCaller())l.callSummary.setOfferAckReceivedTime();l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());}});return l;}return l;},onCallEnded:function k(l,m){switch(m.type){case c('RTCGroupCallActionTypes').CALL_ERROR:case c('RTCGroupCallActionTypes').HANGUP:case c('RTCGroupCallActionTypes').END_CALL:l.callSummary.onCallEnded(m.endCallReason,false,false,m.endCallSubreason);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').DISMISS:l.callSummary.onCallEnded(m.endCallReason,true,false,m.endCallSubreason);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;}return l;},onSurveyResult:function k(l,m){switch(m.type){case c('RTCGroupCallActionTypes').RATING_SHOWN:l.callSummary.addExtraInfo(h.RATING_SHOWN,'1');l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').FEEDBACK_SHOWN:l.callSummary.addExtraInfo(h.SURVEY_SHOWN,'1');l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').SUBMIT_RATING:l.callSummary.addExtraInfo(h.RATING,m.rating);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;case c('RTCGroupCallActionTypes').SUBMIT_FEEDBACK:l.callSummary.addExtraInfo(h.SURVEY_DETAILS,m.feedback);l.callSummary.save(c('FBRTCCallSummaryStore').getInstance());return l;}return l;}};f.exports=j;}),null);
__d('RTCCallControlReducer',['RTCGroupCallActionTypes'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){switch(j.type){case c('RTCGroupCallActionTypes').AUDIO_MUTED:case c('RTCGroupCallActionTypes').AUDIO_UNMUTED:return i.set('localUser',i.localUser.toggleMuteAudio());case c('RTCGroupCallActionTypes').VIDEO_MUTED:case c('RTCGroupCallActionTypes').VIDEO_UNMUTED:return i.set('localUser',i.localUser.toggleMuteVideo());}return i;}f.exports={toggleLocalStream:h};}),null);
__d('RTCUser',['immutable','MultiwayTypes'],(function a(b,c,d,e,f,g){'use strict';var h=c('MultiwayTypes').ParticipantCallState;function i(j){var k=j.FBID,l=j.streams,m=l===undefined?c('immutable').Set():l,n=j.screenStreams,o=n===undefined?c('immutable').Set():n,p=j.profileUrl,q=j.profilePictureUrl,r=j.isMessengerUser,s=r===undefined?false:r,t=j.userName,u=t===undefined?'':t,v=j.userShortName,w=v===undefined?'':v,x=j.participantState,y=j.lastConnectedAt,z=y===undefined?Number.MAX_SAFE_INTEGER:y;Object.assign(this,{FBID:k,streams:m,screenStreams:o,profileUrl:p,profilePictureUrl:q,isMessengerUser:s,userName:u,userShortName:w,participantState:x,lastConnectedAt:z});Object.freeze(this);}i.prototype.clone=function(){return new i(babelHelpers['extends']({},this));};i.prototype.getUserID=function(){return this.FBID;};i.prototype.getProfileUrl=function(){return this.profileUrl;};i.prototype.setProfilePictureUrl=function(j){return j!==this.profilePictureUrl?new i(babelHelpers['extends']({},this,{profilePictureUrl:j})):this;};i.prototype.getProfilePictureUrl=function(){return this.profilePictureUrl;};i.prototype.setIsMessengerUser=function(j){return j!==this.isMessengerUser?new i(babelHelpers['extends']({},this,{isMessengerUser:j})):this;};i.prototype.getIsMessengerUser=function(){return this.isMessengerUser;};i.prototype.getUserName=function(){return this.userName;};i.prototype.getUserShortName=function(){return this.userShortName;};i.prototype.setParticipantState=function(j){if((!this.participantState||this.participantState.state!==h.CONNECTED)&&j.state===h.CONNECTED)return new i(babelHelpers['extends']({},this,{participantState:j,lastConnectedAt:Date.now()}));return new i(babelHelpers['extends']({},this,{participantState:j}));};i.prototype.getParticipantState=function(){return this.participantState;};i.prototype.getLastConnectedAt=function(){return this.lastConnectedAt;};i.prototype.hasAudio=function(){return this.streams.some(function(j){return j.getAudioTracks().length>0;});};i.prototype.hasVideo=function(){return this.streams.some(function(j){return j.getVideoTracks().length>0;});};i.prototype.isAudioMuted=function(){if(!this.hasAudio())return true;return this.streams.every(function(j){return this.areAllTracksMuted(j.getAudioTracks());}.bind(this));};i.prototype.isVideoMuted=function(){if(!this.hasVideo())return true;return this.streams.every(function(j){return this.areAllTracksMuted(j.getVideoTracks());}.bind(this));};i.prototype.areAllTracksMuted=function(j){return !j.some(function(k){return k.enabled;});};i.prototype.isTrackMuted=function(j){return this.streams.some(function(k){var l=k.getTrackById(j);if(!l)return true;return !l.enabled;});};i.prototype.toggleMuteAudio=function(j){this.streams.forEach(function(k){return this.$RTCUser1(k.getAudioTracks(),j);}.bind(this));return this.clone();};i.prototype.toggleMuteVideo=function(j){this.streams.forEach(function(k){return this.$RTCUser1(k.getVideoTracks(),j);}.bind(this));return this.clone();};i.prototype.hasStream=function(){return !this.streams.isEmpty();};i.prototype.getStreams=function(){return this.streams;};i.prototype.addStream=function(j){var k=this.streams.add(j);return k!==this.streams?new i(babelHelpers['extends']({},this,{streams:k})):this;};i.prototype.removeStream=function(j){var k=this.streams['delete'](j);return k!==this.streams?new i(babelHelpers['extends']({},this,{streams:k})):this;};i.prototype.replaceStream=function(j,k){if(!this.streams.contains(j)||j===k)return this;var l=this.streams.add(k)['delete'](j);return l!==this.streams?new i(babelHelpers['extends']({},this,{streams:l})):this;};i.prototype.removeAllStreams=function(){return this.hasStream()?new i(babelHelpers['extends']({},this,{streams:c('immutable').Set()})):this;};i.prototype.hasScreenStream=function(){return !this.screenStreams.isEmpty();};i.prototype.getScreenStreams=function(){return this.screenStreams;};i.prototype.addScreenStream=function(j){var k=this.screenStreams.add(j);return k!==this.screenStreams?new i(babelHelpers['extends']({},this,{screenStreams:k})):this;};i.prototype.removeScreenStream=function(j){var k=this.screenStreams['delete'](j);return k!==this.screenStreams?new i(babelHelpers['extends']({},this,{screenStreams:k})):this;};i.prototype.removeAllScreenStreams=function(){return this.hasScreenStream()?new i(babelHelpers['extends']({},this,{screenStreams:c('immutable').Set()})):this;};i.prototype.$RTCUser1=function(j,k){var l=k!=null?!k:this.areAllTracksMuted(j);j.forEach(function(m){return m.enabled=l;});};f.exports=i;}),null);
__d('RTCCallReducer',['invariant','immutable','MultiwayTypes','RTCCallActionTypes','RTCConferenceState','RTCGroupCallActionTypes','RTCUser','RTCUtils','URI'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('MultiwayTypes').ParticipantCallState,j=c('MultiwayTypes').RtcResponseStatusCode;function k(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').INIT:return aa.set('callInfo',aa.callInfo.set('conferenceName',ba.conferenceName).set('serverInfoData',ba.serverInfoData).set('protocol',ba.protocol));case c('RTCCallActionTypes').RESET:return aa.set('callInfo',aa.callInfo.set('conferenceState',c('RTCConferenceState').NEW).set('conferenceName',ba.conferenceName)).set('callSummary',null).set('connections',c('immutable').Set()).set('remoteUsers',aa.remoteUsers.map(function(ca){return ca.removeAllStreams();}));}return aa;}function l(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').CALL:return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').CONNECTING).set('connections',aa.connections.add(ba.peerConnection));case c('RTCGroupCallActionTypes').CALL_ERROR:return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').TERMINATED);case c('RTCGroupCallActionTypes').CALL_SUCCESS:if(ba.connected)return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').CONNECTED);return aa;}return aa;}function m(aa,ba){switch(ba.type){case c('RTCCallActionTypes').INCOMING_CALL_SUCCESS:return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').CONNECTED);}return aa;}function n(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').HANGUP:aa.connections.forEach(function(ca){return ca.close();});return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').TERMINATING).set('connections',c('immutable').Set()).set('remoteUsers',aa.remoteUsers.map(function(ca){return ca.removeAllStreams();}));case c('RTCGroupCallActionTypes').DISMISS:ba.transaction.sendResponse(ba.request.createResponse(j.OK,{}));case c('RTCGroupCallActionTypes').END_CALL:aa.connections.forEach(function(ca){return ca.close();});return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').TERMINATED).set('connections',c('immutable').Set()).set('remoteUsers',aa.remoteUsers.map(function(ca){return ca.removeAllStreams();}));case c('RTCGroupCallActionTypes').HANGUP_ERROR:case c('RTCGroupCallActionTypes').HANGUP_SUCCESS:return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').TERMINATED);}return aa;}function o(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').ON_PARTICIPANTS_ADDED:var ca=aa.remoteUsers.map(function(da){return da.getUserID();});return aa.set('remoteUsers',aa.remoteUsers.union(Object.keys(ba.participants).filter(function(da){return !ca.has(ba.participants[da].fbid);}).map(function(da){var ea=ba.participants[da];ea.fbid||h(0);return new (c('RTCUser'))({FBID:ea.fbid,profileUrl:new (c('URI'))(ea.href),profilePictureUrl:ea.big_image_src||ea.image_src,isMessengerUser:!!ea.is_messenger_user,userName:ea.name,userShortName:ea.short_name});})));}return aa;}function p(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').ON_CONFERENCE_STATE:var ca=ba.transaction,da=ba.request,ea=ba.request.conferenceStateRequest();if(ba.conferenceStateVersion>=ea.version){ca.sendResponse(da.createResponse(j.OK,{ConferenceStateResponse:{currentVerison:ba.conferenceStateVersion}}));return aa;}ba.resolve(ea.version);var fa=aa.remoteUsers.map(function(ia){var ja=ea.participantStates[ia.getUserID()];return ja?ia.setParticipantState(ja):ia;}),ga=fa.some(function(ia){var ja=ia.getParticipantState();return ja&&ja.state===i.CONNECTED;}),ha=ga?c('RTCConferenceState').CONNECTED:aa.callInfo.conferenceState;ca.sendResponse(da.createResponse(j.OK,{ConferenceStateResponse:{currentVerison:ba.conferenceStateVersion}}));return aa.setIn(['remoteUsers'],fa).setIn(['callInfo','conferenceState'],ha);}return aa;}function q(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').ON_JOIN_RESPONSE:return aa.setIn(['callInfo','serverInfoData'],ba.serverInfoData);}return aa;}function r(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').INIT_LOCAL_USER:return aa.set('localUser',ba.localUser);case c('RTCGroupCallActionTypes').INIT_REMOTE_USERS:return aa.set('remoteUsers',ba.remoteUsers);}return aa;}function s(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').ADD_LOCAL_STREAM:return aa.set('localUser',aa.localUser.addStream(ba.stream));case c('RTCGroupCallActionTypes').REMOVE_LOCAL_STREAM:return aa.set('localUser',aa.localUser.removeStream(ba.stream));case c('RTCGroupCallActionTypes').REPLACE_LOCAL_STREAM:return aa.set('localUser',aa.localUser.replaceStream(ba.oldStream,ba.newStream));case c('RTCGroupCallActionTypes').REMOVE_ALL_LOCAL_STREAMS:if(ba.stopStreams)for(var ca=aa.localUser.getStreams(),da=Array.isArray(ca),ea=0,ca=da?ca:ca[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var fa;if(da){if(ea>=ca.length)break;fa=ca[ea++];}else{ea=ca.next();if(ea.done)break;fa=ea.value;}var ga=fa;c('RTCUtils').stopMediaStream(ga);}return aa.set('localUser',aa.localUser.removeAllStreams());}return aa;}function t(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').ADD_LOCAL_SCREEN_STREAM:return aa.set('localUser',aa.localUser.addScreenStream(ba.stream));case c('RTCGroupCallActionTypes').REMOVE_LOCAL_SCREEN_STREAM:return aa.set('localUser',aa.localUser.removeScreenStream(ba.stream));case c('RTCGroupCallActionTypes').REMOVE_ALL_LOCAL_SCREEN_STREAMS:if(ba.stopStreams)for(var ca=aa.localUser.getScreenStreams(),da=Array.isArray(ca),ea=0,ca=da?ca:ca[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var fa;if(da){if(ea>=ca.length)break;fa=ca[ea++];}else{ea=ca.next();if(ea.done)break;fa=ea.value;}var ga=fa;c('RTCUtils').stopMediaStream(ga);}return aa.set('localUser',aa.localUser.removeAllScreenStreams());}return aa;}function u(aa,ba){var ca=void 0;switch(ba.type){case c('RTCGroupCallActionTypes').ADD_REMOTE_STREAM:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.addStream(ba.stream)));case c('RTCGroupCallActionTypes').REMOVE_REMOTE_STREAM:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.removeStream(ba.stream)));case c('RTCGroupCallActionTypes').REMOVE_ALL_REMOTE_STREAMS:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.removeAllStreams().removeAllScreenStreams()));}return aa;}function v(aa,ba){var ca=void 0;switch(ba.type){case c('RTCGroupCallActionTypes').ADD_REMOTE_TRACK:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.clone()));case c('RTCGroupCallActionTypes').REMOVE_REMOTE_TRACK:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.clone()));}return aa;}function w(aa,ba){var ca=void 0;switch(ba.type){case c('RTCGroupCallActionTypes').ADD_REMOTE_SCREEN_STREAM:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.addScreenStream(ba.stream)));case c('RTCGroupCallActionTypes').REMOVE_REMOTE_SCREEN_STREAM:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.removeScreenStream(ba.stream)));}return aa;}function x(aa,ba){var ca=void 0;switch(ba.type){case c('RTCGroupCallActionTypes').TOGGLE_REMOTE_STREAM:return aa.set('remoteUsers',Object.entries(ba.mediaStatus).reduce(function(da,ea){var fa=ea[0],ga=ea[1],ha=da.reduce(function(ka,la){var ma=la.getStreams().map(function(na){return na.getTracks().find(function(oa){return oa.id===fa;});}).find(Boolean);return ma?{user:la,track:ma}:ka;},{}),ia=ha.user,ja=ha.track;if(ia&&ja){if(ja.kind==='audio'&&ia.isAudioMuted()===ga)return da['delete'](ia).add(ia.toggleMuteAudio());if(ja.kind==='video'&&ia.isVideoMuted()===ga)return da['delete'](ia).add(ia.toggleMuteVideo());}return da;},aa.remoteUsers));case c('RTCCallActionTypes').REMOTE_VIDEO_MUTED:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.toggleMuteVideo(true)));case c('RTCCallActionTypes').REMOTE_VIDEO_UNMUTED:ca=y(aa,ba);if(!ca)return aa;return aa.setIn(['remoteUsers'],aa.remoteUsers['delete'](ca).add(ca.toggleMuteVideo(false)));}return aa;}function y(aa,ba){return aa.remoteUsers.find(function(ca){if(ba.userID)return ca.getUserID()==ba.userID;return ca.getUserID()===ba.stream.id.split(':')[0];});}function z(aa,ba){switch(ba.type){case c('RTCGroupCallActionTypes').WAIT_FOR_USER_INPUT:if(aa.callInfo.conferenceState===c('RTCConferenceState').NEW)return aa.setIn(['callInfo','conferenceState'],c('RTCConferenceState').AWAITING_USER_START);return aa;}return aa;}f.exports={callInit:k,callStart:l,callEnd:n,onParticipantsChanged:o,incomingCallStart:m,initUsers:r,processLocalStream:s,processLocalScreenStream:t,processRemoteStream:u,processRemoteScreenStream:w,processRemoteTrack:v,toggleRemoteStream:x,processConferenceState:p,processJoinResponse:q,waitForUserInput:z};}),null);
__d('RTCCallStoreState',['CurrentUser','immutable','RTCConferenceState','RTCUser'],(function a(b,c,d,e,f,g){'use strict';var h,i,j,k,l={debugID:0,conferenceState:c('RTCConferenceState').NEW,conferenceName:'',protocol:'',serverInfoData:''};h=babelHelpers.inherits(m,c('immutable').Record(l));i=h&&h.prototype;function m(){h.apply(this,arguments);}var n={connections:c('immutable').Set(),localUser:new (c('RTCUser'))({FBID:c('CurrentUser').getID()}),remoteUsers:c('immutable').Set(),callInfo:new m(),callSummary:null};j=babelHelpers.inherits(o,c('immutable').Record(n));k=j&&j.prototype;function o(){j.apply(this,arguments);}f.exports=o;}),null);
__d('RTCGroupCallDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:true});}),null);
__d('RTCCallStore',['FBRTCCallSummaryReducer','FluxReduceStore','RTCCallControlReducer','RTCCallReducer','RTCCallStoreState','RTCGroupCallDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[c('FBRTCCallSummaryReducer').onCallEnded,c('FBRTCCallSummaryReducer').onCallStarted,c('FBRTCCallSummaryReducer').onMessageSignaling,c('FBRTCCallSummaryReducer').onSurveyResult,c('FBRTCCallSummaryReducer').setCallSummary,c('FBRTCCallSummaryReducer').setMWCallType,c('RTCCallControlReducer').toggleLocalStream,c('RTCCallReducer').callEnd,c('RTCCallReducer').callInit,c('RTCCallReducer').callStart,c('RTCCallReducer').incomingCallStart,c('RTCCallReducer').initUsers,c('RTCCallReducer').onParticipantsChanged,c('RTCCallReducer').processConferenceState,c('RTCCallReducer').processJoinResponse,c('RTCCallReducer').processLocalScreenStream,c('RTCCallReducer').processLocalStream,c('RTCCallReducer').processRemoteScreenStream,c('RTCCallReducer').processRemoteStream,c('RTCCallReducer').processRemoteTrack,c('RTCCallReducer').toggleRemoteStream,c('RTCCallReducer').waitForUserInput];h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('RTCCallStoreState'))();};k.prototype.reduce=function(l,m){return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('RTCGroupCallDispatcher'));}),null);
__d('RTCGroupCallActions',['RTCGroupCallActionTypes','RTCGroupCallDispatcher','RTCUtils'],(function a(b,c,d,e,f,g){'use strict';var h={setMWCallType:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_MW_CALL_TYPE,callType:j});},setLayout:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_LAYOUT,layout:j});},setDominantSpeaker:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_DOMINANT_SPEAKER,dominantSpeakerFBID:j});},setPinnedSpeaker:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_PINNED_SPEAKER,pinnedSpeakerFBID:j});},setUseDominantSpeakeView:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_USE_DOMINANT_SPEAKE_VIEW,useDominantSpeakeView:j});},setUseGridView:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_GRID_VIEW,useGridView:j});},initThread:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').INIT_THREAD,thread:j,participants:k});},onParticipantLeft:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_PARTICIPANT_LEFT,participantFBID:j});},onParticipantsAdded:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_PARTICIPANTS_ADDED,participants:j});},addParticipantsToRing:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_PARTICIPANTS_TO_RING,participantFBIDs:j});},toggleRemoteStream:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').TOGGLE_REMOTE_STREAM,mediaStatus:j});},handleDismissRequest:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').DISMISS,transaction:j,request:k,endCallReason:c('RTCUtils').endCallReasonFromDismissRequest(k.dismissRequest())});},handleConferenceStateRequest:function i(j,k,l,m){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_CONFERENCE_STATE,transaction:j,request:k,conferenceStateVersion:l,resolve:m});},onJoinRequestSent:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_JOIN_REQUEST_SENT});},onJoinResponse:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_JOIN_RESPONSE,serverInfoData:j});},onServerMediaUpdateSuccess:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_SERVER_MEDIA_UPDATE_SUCCESS});},onClientMediaUpdateResponse:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ON_CLIENT_MEDIA_UPDATE_RESPONSE,responseStatusCode:j,currentVersion:k});}};f.exports=h;}),null);
__d('RTCMWSessionDescription',['Promise','MultiwayTypes','RTCCallStore','RTCConfig','RTCGroupCallActions','RTCGroupCallDialogController'],(function a(b,c,d,e,f,g){'use strict';var h=c('MultiwayTypes').MediaType,i={_videoEnabled:{},serverMediaUpdate:function j(k,l){var m,n=k.fromVersion,o=k.toVersion,p=k.mediaUpdates,q=c('RTCCallStore').getState().connections.first(),r=q.getLocalDescription(),s=q.getRemoteDescription(),t=s.sessionDescription.getVersion();if(t!==n){l(t);return;}var u=function(){p.forEach(function(w){s.processServerMediaUpdate(w);w.media.forEach(function(x){var y=x.type,z=x.enabled;if(y===h.VIDEO)this._videoEnabled[w.sourceKey]=z;}.bind(this));}.bind(this));s.sessionDescription.setVersion(o);c('Promise').all([q.setLocalDescription(r),q.setRemoteDescription(s)]).then(function(){var w;c('RTCGroupCallActions').toggleRemoteStream((w=[]).concat.apply(w,p.map(function(x){var y=x.media;return y;})).reduce(function(x,y){var z=y.id,aa=y.enabled;x[z]=aa;return x;},{}));l(o);},function(){return l(t);})['catch'](function(w){});}.bind(this),v=p.find(function(w){var x=w.sourceKey,y=w.media;return !this._videoEnabled[x]&&y.some(function(z){var aa=z.type,ba=z.enabled;return aa===h.VIDEO&&ba;});}.bind(this));if(c('RTCConfig').RtcConferencingVideoGK&&!c('RTCCallStore').getState().localUser.hasVideo()&&v){(function(){var w=v.sourceKey.split(':'),x=w[0],y=c('RTCCallStore').getState().remoteUsers.find(function(z){return z.getUserID()===x;});c('RTCGroupCallDialogController').showVideoEscalationDialog(y.getUserName(),u);})();}else u();}};f.exports=i;}),null);
__d('RTCCallActions',['RTCCallActionTypes','RTCGroupCallActionTypes','RTCGroupCallDispatcher','RTCUtils','emptyFunction','mixInEventEmitter'],(function a(b,c,d,e,f,g){'use strict';var h={addListener:c('emptyFunction'),emit:c('emptyFunction'),initialize:function i(j,k,l,m,n){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').INIT,conferenceName:k,callID:m,serverInfoData:l,protocol:j,callTrigger:n});},reset:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCCallActionTypes').RESET,conferenceName:j});},setCallSummary:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SET_CALL_SUMMARY,callSummary:j});},call:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').CALL,usersToRing:j,peerConnection:k});},callSuccess:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').CALL_SUCCESS,connected:j});},incomingCallSuccess:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCCallActionTypes').INCOMING_CALL_SUCCESS});},callError:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').CALL_ERROR,endCallReason:c('RTCUtils').endCallReasonFromResponseStatusCode(j),endCallSubreason:'Call error: '+(j||0)});},hangupSuccess:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').HANGUP_SUCCESS});},hangupError:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').HANGUP_ERROR,error:j});},join:function i(j){h.call([],j);},hangup:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').HANGUP,hangupReason:j,detailedReasonString:k,endCallReason:c('RTCUtils').endCallReasonFromHangupReason(j)});},initLocalUser:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').INIT_LOCAL_USER,localUser:j});},initRemoteUsers:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').INIT_REMOTE_USERS,remoteUsers:j});},addLocalStream:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_LOCAL_STREAM,stream:j});},removeLocalStream:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_LOCAL_STREAM,stream:j});},replaceLocalStream:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REPLACE_LOCAL_STREAM,oldStream:j,newStream:k});},removeAllLocalStreams:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_ALL_LOCAL_STREAMS,stopStreams:j});},removeAllLocalScreenStreams:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_ALL_LOCAL_SCREEN_STREAMS,stopStreams:j});},addRemoteStream:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_REMOTE_STREAM,stream:j,userID:k});},removeRemoteStream:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_REMOTE_STREAM,stream:j,userID:k});},removeAllRemoteStreams:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_ALL_REMOTE_STREAMS,userID:j});},addRemoteTrack:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_REMOTE_TRACK,stream:j,track:k});},removeRemoteTrack:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_REMOTE_TRACK,stream:j,track:k});},addLocalScreenStream:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_LOCAL_SCREEN_STREAM,stream:j});},removeLocalScreenStream:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_LOCAL_SCREEN_STREAM,stream:j});},addRemoteScreenStream:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').ADD_REMOTE_SCREEN_STREAM,stream:j,userID:k});},removeRemoteScreenStream:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').REMOVE_REMOTE_SCREEN_STREAM,stream:j,userID:k});},endCall:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').END_CALL,endCallReason:j,endCallSubreason:k});},waitForUserInput:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').WAIT_FOR_USER_INPUT});},toggleMuteAudio:function i(j){c('RTCGroupCallDispatcher').dispatch({type:j?c('RTCGroupCallActionTypes').AUDIO_UNMUTED:c('RTCGroupCallActionTypes').AUDIO_MUTED});},toggleMuteVideo:function i(j){c('RTCGroupCallDispatcher').dispatch({type:j?c('RTCGroupCallActionTypes').VIDEO_UNMUTED:c('RTCGroupCallActionTypes').VIDEO_MUTED});},toggleMuteRemoteVideo:function i(j,k){c('RTCGroupCallDispatcher').dispatch({type:j?c('RTCCallActionTypes').REMOTE_VIDEO_MUTED:c('RTCCallActionTypes').REMOTE_VIDEO_UNMUTED,userID:k});},toggleSelfView:function i(j){c('RTCGroupCallDispatcher').dispatch({type:j?c('RTCGroupCallActionTypes').SELF_VIEW_COLLAPSED:c('RTCGroupCallActionTypes').SELF_VIEW_UNCOLLAPSED});},submitRating:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SUBMIT_RATING,rating:j});},submitFeedback:function i(j){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').SUBMIT_FEEDBACK,feedback:j});},ratingShown:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').RATING_SHOWN});},feedbackShown:function i(){c('RTCGroupCallDispatcher').dispatch({type:c('RTCGroupCallActionTypes').FEEDBACK_SHOWN});}};c('mixInEventEmitter')(h,{onIceConnectionStateChange:true});f.exports=h;}),null);
__d('RTCMultiwayMessageHandler',['Arbiter','ChannelConstants','CurrentUser','FBRTCCallSummary','FBRTCMultiwayMessage','FBRTCTransactions','MercuryIDs','MercuryParticipants','MultiwayTypes','RTCCallActions','RTCCallStore','RTCGroupCallActions','RTCMWProtocolHandler','RTCMWSessionDescription','RTCUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBRTCTransactions').FBRTCServerTransaction,i=c('FBRTCTransactions').FBRTCTransactionOwner,j=c('MultiwayTypes').Capability,k=c('MultiwayTypes').HangupReason,l=c('MultiwayTypes').RtcResponseStatusCode,m=c('MultiwayTypes').DeviceStatus;function n(){this.$RTCMultiwayMessageHandler3=-1;this.$RTCMultiwayMessageHandler5();}n.prototype.initialize=function(o,p){this.$RTCMultiwayMessageHandler1=o;this.$RTCMultiwayMessageHandler2=p;};n.initHandler=function(o,p){new n().initialize(o,p);};n.close=function(){if(n.$RTCMultiwayMessageHandler4){c('Arbiter').unsubscribe(n.$RTCMultiwayMessageHandler4);n.$RTCMultiwayMessageHandler4=null;}};n.prototype.$RTCMultiwayMessageHandler5=function(){n.$RTCMultiwayMessageHandler4=c('Arbiter').subscribe([c('ChannelConstants').getArbiterType('rtc_live_json'),c('ChannelConstants').getArbiterType('rtc_multi_json')],function(o,p){this.$RTCMultiwayMessageHandler6(p.obj);}.bind(this));};n.prototype.$RTCMultiwayMessageHandler6=function(o){var p,q=this,r=new (c('FBRTCMultiwayMessage'))(o);if(!r.isRequest())return;if(this.$RTCMultiwayMessageHandler1===r.conferenceName()){this.$RTCMultiwayMessageHandler7(r);}else (function(){var s=new h(new i(),r);s.start().done(function(t){var u=c('RTCUtils').generateRandomInt(),v=new (c('FBRTCCallSummary'))({peerID:c('RTCUtils').isGroupCall(t.conferenceName())?-1:c('RTCUtils').getPeerID(t.conferenceName()),callID:u,isCaller:false});s.sendResponse(this.$RTCMultiwayMessageHandler8(t,u,v)).done(function(){return c('RTCMWProtocolHandler').otherUserInAnotherCall(r.conferenceName(),r.serverInfoData(),k.IN_ANOTHER_CALL,'InAnotherCall');});}.bind(q));})();};n.prototype.$RTCMultiwayMessageHandler8=function(o,p,q){var r=o.ringRequest(),s=o.serverInfoData();if(r==null||s==null)return o.createResponse(l.BAD_REQUEST);var t={deviceCapabilities:[j.SUPPORT_AUDIO,j.SUPPORT_VIDEO],deviceStatus:m.OK};return o.createResponse(l.OK,{ringResponse:t});};n.prototype.$RTCMultiwayMessageHandler7=function(o){var p=new h(new i(),o);p.start().then(function(q){var r,s=this;if(q!=null)if(q.dismissRequest()!=null){var t=c('RTCCallStore').getState(),u=t.callInfo,v=t.connections;if(q.serverInfoData()===u.serverInfoData){c('RTCGroupCallActions').handleDismissRequest(p,q);n.close();v.forEach(function(w){return w.close();});c('RTCCallActions').removeAllLocalStreams(true);}}else if(q.serverMediaUpdateRequest()!=null){c('RTCMWSessionDescription').serverMediaUpdate(q.serverMediaUpdateRequest(),function(w){c('RTCGroupCallActions').onServerMediaUpdateSuccess();p.sendResponse(q.createResponse(l.OK,{serverMediaUpdateResponse:{currentVersion:w}}));});}else if(q.conferenceStateRequest()!=null)(function(){var w=c('RTCCallStore').getState(),x=w.remoteUsers,y=x.map(function(ca){return ca.getUserID();}),z=Object.keys(q.conferenceStateRequest().participantStates),aa=z.filter(function(ca){return ca!==c('CurrentUser').getID()&&!y.has(ca);});if(aa.length>0){var ba=aa.map(function(ca){return c('MercuryIDs').getParticipantIDFromUserID(ca);});c('MercuryParticipants').getMulti(ba,function(ca){c('RTCGroupCallActions').onParticipantsAdded(ca);c('RTCGroupCallActions').handleConferenceStateRequest(p,q,this.$RTCMultiwayMessageHandler3,function(da){this.$RTCMultiwayMessageHandler3=da;}.bind(this));}.bind(s));}else c('RTCGroupCallActions').handleConferenceStateRequest(p,q,s.$RTCMultiwayMessageHandler3,function(ca){this.$RTCMultiwayMessageHandler3=ca;}.bind(s));})();}.bind(this)).done();};f.exports=n;}),null);
__d('FBRTCClientMediaUpdateReducer',['RTCCallStore','RTCGroupCallActionTypes','RTCMWProtocolHandler','MultiwayTypes'],(function a(b,c,d,e,f,g){'use strict';var h=c('MultiwayTypes').RtcResponseStatusCode,i={configureAudio:function l(m,n){switch(n.type){case c('RTCGroupCallActionTypes').AUDIO_MUTED:return j(m,'audio',false);case c('RTCGroupCallActionTypes').AUDIO_UNMUTED:return j(m,'audio',true);}return m;},configureVideo:function l(m,n){switch(n.type){case c('RTCGroupCallActionTypes').VIDEO_MUTED:return j(m,'video',false);case c('RTCGroupCallActionTypes').VIDEO_UNMUTED:return j(m,'video',true);}return m;},onClientMediaUpdateResponse:function l(m,n){switch(n.type){case c('RTCGroupCallActionTypes').ON_CLIENT_MEDIA_UPDATE_RESPONSE:if(n.responseStatusCode!==h.OK)return m;m=m.setIn(['clientMediaUpdateInfo','lastSyncedClientVersion'],n.currentVersion);if(m.clientMediaUpdateInfo.pendingResponse){m=m.setIn(['clientMediaUpdateInfo','pendingResponse'],false);if(m.clientMediaUpdateInfo.pendingUpdate)return k(m.setIn(['clientMediaUpdateInfo','pendingUpdate'],false));}return m;}return m;}};function j(l,m,n){var o=c('RTCCallStore').getState().connections.first().getLocalStreams()[0].getTracks().reduce(function(p,q){p[q.id]=q.kind===m?n:q.enabled;return p;},{});return k(l.setIn(['clientMediaUpdateInfo','localMediaUpdates'],l.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:o})));}function k(l){if(l.clientMediaUpdateInfo.pendingResponse)return l.setIn(['clientMediaUpdateInfo','pendingUpdate'],true);var m=l.clientMediaUpdateInfo.localMediaUpdates.reduce(function(n,o,p){if(p>=l.clientMediaUpdateInfo.lastSyncedClientVersion)n.push(o);return n;},[]);if(m.length===0)return l;c('RTCMWProtocolHandler').clientMediaUpdate(c('RTCCallStore').getState().callInfo.conferenceName,c('RTCCallStore').getState().callInfo.serverInfoData,l.clientMediaUpdateInfo.lastSyncedClientVersion,l.clientMediaUpdateInfo.localMediaUpdates.size,m);return l.setIn(['clientMediaUpdateInfo','pendingResponse'],true);}f.exports=i;}),null);
__d('FBRTCGroupCallParticipantsReducer',['MercuryIDs','RTCCallStore','RTCGroupCallActionTypes','RTCMWProtocolHandler','Set'],(function a(b,c,d,e,f,g){'use strict';var h={_participantsToRing:new (c('Set'))(),initThread:function i(j,k){switch(k.type){case c('RTCGroupCallActionTypes').INIT_THREAD:return j.merge({participants:k.participants,thread:k.thread});}return j;},onParticipantsChanged:function i(j,k){switch(k.type){case c('RTCGroupCallActionTypes').ON_PARTICIPANT_LEFT:return j.set('participants',j.participants['delete'](c('MercuryIDs').getParticipantIDFromUserID(k.participantFBID)));case c('RTCGroupCallActionTypes').ON_PARTICIPANTS_ADDED:var l=Object.keys(k.participants).map(function(m){return k.participants[m].fbid;}).filter(function(m){return h._participantsToRing.has(m);});if(l.length!==0){l.forEach(function(m){return h._participantsToRing['delete'](m);});c('RTCMWProtocolHandler').addParticipants(c('RTCCallStore').getState().callInfo.conferenceName,c('RTCCallStore').getState().callInfo.serverInfoData,l);}return j.set('participants',j.participants.merge(k.participants));}return j;},addParticipantsToRing:function i(j,k){switch(k.type){case c('RTCGroupCallActionTypes').ADD_PARTICIPANTS_TO_RING:k.participantFBIDs.forEach(function(l){return h._participantsToRing.add(l);});return j;}return j;}};f.exports=h;}),null);
__d('FBRTCGroupCallReducer',['MultiwayTypes','RTCCallStore','RTCEndCallReason','RTCGroupCallActionTypes','RTCMWProtocolHandler'],(function a(b,c,d,e,f,g){'use strict';var h=c('MultiwayTypes').ParticipantCallState,i={setDominantSpeaker:function j(k,l){switch(l.type){case c('RTCGroupCallActionTypes').SET_DOMINANT_SPEAKER:return k.set('dominantSpeakerFBID',l.dominantSpeakerFBID);case c('RTCGroupCallActionTypes').SET_PINNED_SPEAKER:var m=c('RTCCallStore').getState(),n=m.callInfo,o=m.connections;c('RTCMWProtocolHandler').subscription(n.conferenceName,n.serverInfoData,o.first().getRemoteStreams(),k.layout,l.pinnedSpeakerFBID);return k.set('pinnedSpeakerFBID',l.pinnedSpeakerFBID);case c('RTCGroupCallActionTypes').ON_CONFERENCE_STATE:var p=l.request.conferenceStateRequest(),q=p.participantStates,r=q[k.pinnedSpeakerFBID];if(r&&r.state!==h.CONNECTED)return k.set('pinnedSpeakerFBID',null);return k;}return k;},setLayout:function j(k,l){switch(l.type){case c('RTCGroupCallActionTypes').SET_LAYOUT:var m=c('RTCCallStore').getState(),n=m.callInfo,o=m.connections;if(o.size>0)c('RTCMWProtocolHandler').subscription(n.conferenceName,n.serverInfoData,o.first().getRemoteStreams(),l.layout,k.pinnedSpeakerFBID);return k.set('layout',l.layout);}return k;},setGKSettings:function j(k,l){switch(l.type){case c('RTCGroupCallActionTypes').SET_USE_DOMINANT_SPEAKE_VIEW:return k.set('useDominantSpeakeView',l.useDominantSpeakeView);case c('RTCGroupCallActionTypes').SET_GRID_VIEW:return k.set('useGridView',l.useGridView);}return k;},processEndCallReason:function j(k,l){switch(l.type){case c('RTCGroupCallActionTypes').CALL_ERROR:case c('RTCGroupCallActionTypes').HANGUP:case c('RTCGroupCallActionTypes').END_CALL:case c('RTCGroupCallActionTypes').DISMISS:return k.set('endCallReason',k.endCallReason||new (c('RTCEndCallReason'))(l.endCallReason));}return k;}};f.exports=i;}),null);
__d('RTCStreamDurationTracker',['performanceNow'],(function a(b,c,d,e,f,g){'use strict';function h(){var i=arguments.length<=0||arguments[0]===undefined?'mixed':arguments[0];this.$RTCStreamDurationTracker3=0;this.$RTCStreamDurationTracker4=0;this.$RTCStreamDurationTracker5=false;this.update=function(){if(!this.$RTCStreamDurationTracker5)return;if(this.$RTCStreamDurationTracker6()){if(this.$RTCStreamDurationTracker4===0)this.$RTCStreamDurationTracker4=c('performanceNow')();}else{this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker4=0;}}.bind(this);this.$RTCStreamDurationTracker1=i;}h.prototype.isStarted=function(){return this.$RTCStreamDurationTracker5;};h.prototype.track=function(i){if(i===this.$RTCStreamDurationTracker2){this.update();return;}if(this.$RTCStreamDurationTracker2&&this.$RTCStreamDurationTracker5){var j=this.$RTCStreamDurationTracker2;j.removeEventListener('addtrack',this.update);j.removeEventListener('removetrack',this.update);}if(i){this.$RTCStreamDurationTracker2=i;if(this.$RTCStreamDurationTracker5)this.start();}else this.stop();};h.prototype.$RTCStreamDurationTracker6=function(){if(!this.$RTCStreamDurationTracker2)return false;return this.$RTCStreamDurationTracker7().some(function(i){return i.enabled;});};h.prototype.$RTCStreamDurationTracker7=function(){if(!this.$RTCStreamDurationTracker2)return [];switch(this.$RTCStreamDurationTracker1){case 'audio':return this.$RTCStreamDurationTracker2.getAudioTracks();case 'video':return this.$RTCStreamDurationTracker2.getVideoTracks();default:return this.$RTCStreamDurationTracker2.getTracks();}};h.prototype.getDuration=function(){return this.$RTCStreamDurationTracker4===0?this.$RTCStreamDurationTracker3:this.$RTCStreamDurationTracker3+c('performanceNow')()-this.$RTCStreamDurationTracker4;};h.prototype.start=function(){this.$RTCStreamDurationTracker5=true;if(this.$RTCStreamDurationTracker6())this.$RTCStreamDurationTracker4=c('performanceNow')();if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.addEventListener('addtrack',this.update);i.addEventListener('removetrack',this.update);}};h.prototype.stop=function(){if(!this.$RTCStreamDurationTracker5)return;this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker5=false;this.$RTCStreamDurationTracker4=0;if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.removeEventListener('addtrack',this.update);i.removeEventListener('removetrack',this.update);}};f.exports=h;}),null);
__d('FBRTCGroupCallStoreState',['immutable','RTCStreamDurationTracker'],(function a(b,c,d,e,f,g){'use strict';var h,i,j,k,l,m,n={pendingResponse:false,pendingUpdate:false,lastSyncedClientVersion:2,localMediaUpdates:c('immutable').List([{mediaStatus:{}},{mediaStatus:{}}])};h=babelHelpers.inherits(o,c('immutable').Record(n));i=h&&h.prototype;function o(){h.apply(this,arguments);}var p={localVideoDurationTracker:new (c('RTCStreamDurationTracker'))('video'),remoteVideoDurationTracker:new (c('RTCStreamDurationTracker'))('video')};j=babelHelpers.inherits(q,c('immutable').Record(p));k=j&&j.prototype;function q(){j.apply(this,arguments);}var r={dominantSpeakerFBID:null,endCallReason:null,layout:null,participants:null,pinnedSpeakerFBID:null,thread:null,clientMediaUpdateInfo:new o(),useDominantSpeakeView:false,useGridView:false,videoDurationTrackerInfo:new q()};l=babelHelpers.inherits(s,c('immutable').Record(r));m=l&&l.prototype;function s(){l.apply(this,arguments);}f.exports=s;}),null);
__d('FBRTCVideoDurationTrackerReducer',['FBRTCCallSummaryStore','RTCCallStore','RTCGroupCallActionTypes'],(function a(b,c,d,e,f,g){'use strict';var h={track:function i(j,k){var l=j.videoDurationTrackerInfo,m=l.localVideoDurationTracker,n=l.remoteVideoDurationTracker;switch(k.type){case c('RTCGroupCallActionTypes').ADD_LOCAL_STREAM:m.start();m.track(k.stream);return j;case c('RTCGroupCallActionTypes').ADD_REMOTE_STREAM:case c('RTCGroupCallActionTypes').TOGGLE_REMOTE_STREAM:var o=c('RTCCallStore').getState(),p=o.remoteUsers,q=p.find(function(r){return !r.isVideoMuted();});n.stop();n.start();n.track(q&&q.getStreams().first());return j;}return j;},update:function i(j,k){switch(k.type){case c('RTCGroupCallActionTypes').VIDEO_MUTED:case c('RTCGroupCallActionTypes').VIDEO_UNMUTED:j.videoDurationTrackerInfo.localVideoDurationTracker.update();}return j;},stop:function i(j,k){switch(k.type){case c('RTCGroupCallActionTypes').DISMISS:case c('RTCGroupCallActionTypes').END_CALL:case c('RTCGroupCallActionTypes').HANGUP:var l=j.videoDurationTrackerInfo,m=c('RTCCallStore').getState(),n=m.callSummary;n.setVideoDurations(l.localVideoDurationTracker.getDuration(),l.remoteVideoDurationTracker.getDuration());n.save(c('FBRTCCallSummaryStore').getInstance());return j;}return j;}};f.exports=h;}),null);
__d('FBRTCGroupCallStore',['FBRTCClientMediaUpdateReducer','FBRTCGroupCallParticipantsReducer','FBRTCGroupCallReducer','FBRTCGroupCallStoreState','FBRTCVideoDurationTrackerReducer','FluxReduceStore','RTCGroupCallDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[c('FBRTCClientMediaUpdateReducer').configureAudio,c('FBRTCClientMediaUpdateReducer').configureVideo,c('FBRTCClientMediaUpdateReducer').onClientMediaUpdateResponse,c('FBRTCGroupCallParticipantsReducer').addParticipantsToRing,c('FBRTCGroupCallParticipantsReducer').initThread,c('FBRTCGroupCallParticipantsReducer').onParticipantsChanged,c('FBRTCGroupCallReducer').processEndCallReason,c('FBRTCGroupCallReducer').setDominantSpeaker,c('FBRTCGroupCallReducer').setGKSettings,c('FBRTCGroupCallReducer').setLayout,c('FBRTCVideoDurationTrackerReducer').track,c('FBRTCVideoDurationTrackerReducer').update,c('FBRTCVideoDurationTrackerReducer').stop];h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('FBRTCGroupCallStoreState'))();};k.prototype.reduce=function(l,m){return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('RTCGroupCallDispatcher'));}),null);
__d('FBRTCGroupCallVideoEscalationDialog.react',['fbt','FBRTCConstants','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogFooter.react','React','RTCGroupCallActions','RTCMWProtocolHandler'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('FBRTCConstants').CallType,j=function k(l){var m=l.userName,n=l.onToggle;return c('React').createElement(c('MessengerDialog.react'),{onToggle:n},c('React').createElement(c('MessengerDialogBody.react'),null,h._("{name} added video chat. Would you like to share your video?",[h.param('name',m)])),c('React').createElement(c('MessengerDialogFooter.react'),null,c('React').createElement(c('MessengerDialogCancelButton.react'),{onClick:function o(){return c('RTCGroupCallActions').setMWCallType(i.ESCALATION_DECLINED);}}),c('React').createElement(c('MessengerDialogButton.react'),{label:h._("Share Video"),onClick:function o(){c('RTCMWProtocolHandler').videoEscalation();n();},type:'primary'})));};f.exports=j;}),null);
__d('RTCGroupCallAddGroupMembersDialog.react',['cx','fbt','MessengerDialog.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogHeader.react','MessengerDialogTitle.react','MessengerRTCGroupCallContactList.react','MessengerRTCGroupCallRingParticipantsRow.react','MessengerRTCGroupCallThreadRow.react','React','RTCCallStore','RTCMWProtocolHandler'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PureComponent,m=460;j=babelHelpers.inherits(n,l);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={isParticipantSelected:this.props.participants.mapEntries(function(t){var u=t[0],v=t[1];return [u,false];})},this.$RTCGroupCallAddGroupMembersDialog1=function(){c('RTCMWProtocolHandler').addParticipants(c('RTCCallStore').getState().callInfo.conferenceName,c('RTCCallStore').getState().callInfo.serverInfoData,this.$RTCGroupCallAddGroupMembersDialog2().map(function(t){var u=t.fbid;return u||'';}));this.props.onUnmount();}.bind(this),p;}n.prototype.render=function(){var o=this.props,p=o.participants,q=o.participantStates,r=o.thread,s=o.viewerID,t;if(r){t=i._("Add group members");}else t=i._("Call Participants");return c('React').createElement(c('MessengerDialog.react'),{onToggle:this.props.onUnmount,type:'default',width:m},c('React').createElement('div',{className:"_1axt"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogCancelButton.react'),null),c('React').createElement(c('MessengerDialogTitle.react'),null,t),c('React').createElement(c('MessengerDialogButton.react'),{label:i._("Ring"),onClick:this.$RTCGroupCallAddGroupMembersDialog1,disabled:this.$RTCGroupCallAddGroupMembersDialog2().length===0,type:'primary'})),c('React').createElement(c('MessengerRTCGroupCallThreadRow.react'),{participants:p,thread:r,viewerID:s}),c('React').createElement(c('MessengerRTCGroupCallRingParticipantsRow.react'),{names:this.$RTCGroupCallAddGroupMembersDialog2().map(function(u){var v=u.name;return v;}).sort(function(u,v){return u.localeCompare(v);})}),c('React').createElement(c('MessengerRTCGroupCallContactList.react'),{participants:p.toArray().sort(function(u,v){return u.name.localeCompare(v.name);}),participantStates:q,isParticipantSelected:this.state.isParticipantSelected,onClick:function(u){return this.setState({isParticipantSelected:this.state.isParticipantSelected.set(u,!this.state.isParticipantSelected.get(u))});}.bind(this)})));};n.prototype.$RTCGroupCallAddGroupMembersDialog2=function(){return this.props.participants.filter(function(o,p){return this.state.isParticipantSelected.get(p);}.bind(this)).toArray();};f.exports=n;}),null);
__d('RTCGroupCallAddMembersDialog.react',['cx','fbt','immutable','MercuryIDs','MercuryLogMessageType','MercuryMessageActions','MercuryMessageObject','MercuryTriodeSourceUtil','MessengerAdminGroupUtils','MessengerDialog.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogHeader.react','MessengerDialogTitle.react','MessengerGraphQLTokenizer.react','MessengerRTCGroupCallContactList.react','MessengerRTCGroupCallThreadRow.react','React','RTCCallStore','RTCGroupCallActions','RTCMWProtocolHandler'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PureComponent,m=460;j=babelHelpers.inherits(n,l);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={isParticipantSelected:this.props.participants.mapEntries(function(t){var u=t[0],v=t[1];return [u,false];}),newParticipants:c('immutable').List()},this.$RTCGroupCallAddMembersDialog1=function(t){this.setState({isParticipantSelected:this.state.isParticipantSelected.set(t,!this.state.isParticipantSelected.get(t))});}.bind(this),this.$RTCGroupCallAddMembersDialog2=function(){this.props.onUnmount();c('RTCGroupCallActions').addParticipantsToRing(this.state.newParticipants.toArray().map(function(t){return t.getUniqueID();}));this.$RTCGroupCallAddMembersDialog7();if(this.$RTCGroupCallAddMembersDialog3().length>0)c('RTCMWProtocolHandler').addParticipants(c('RTCCallStore').getState().callInfo.conferenceName,c('RTCCallStore').getState().callInfo.serverInfoData,this.$RTCGroupCallAddMembersDialog3().map(function(t){var u=t.fbid;return u||'';}));}.bind(this),this.$RTCGroupCallAddMembersDialog4=function(t){this.setState({newParticipants:this.state.newParticipants.push(t)});}.bind(this),this.$RTCGroupCallAddMembersDialog6=function(t){var u=t.getUniqueID(),v=this.state.newParticipants,w=v.findIndex(function(x){return x.getUniqueID()===u;});if(w!==-1)this.setState({newParticipants:v['delete'](w)});}.bind(this),this.$RTCGroupCallAddMembersDialog5=function(){this.setState({newParticipants:c('immutable').List()});}.bind(this),p;}n.prototype.render=function(){var o=this.props,p=o.participants,q=o.participantStates,r=o.thread,s=o.viewerID,t=c('React').createElement('div',{className:"_2t45"},c('React').createElement('div',{className:"_225b"},i._("Group Members")),c('React').createElement(c('MessengerRTCGroupCallContactList.react'),{isParticipantSelected:this.state.isParticipantSelected,onClick:this.$RTCGroupCallAddMembersDialog1,participants:p.toArray().sort(function(u,v){return u.name.localeCompare(v.name);}),participantStates:q}));return c('React').createElement(c('MessengerDialog.react'),{onToggle:this.props.onUnmount,type:'default',width:m},c('React').createElement('div',{className:"_5zad"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogCancelButton.react'),null),c('React').createElement(c('MessengerDialogTitle.react'),null,i._("Add group members")),c('React').createElement(c('MessengerDialogButton.react'),{label:i._("Ring"),onClick:this.$RTCGroupCallAddMembersDialog2,disabled:this.$RTCGroupCallAddMembersDialog3().length+this.state.newParticipants.size===0,type:'primary'})),c('React').createElement(c('MessengerRTCGroupCallThreadRow.react'),{displayAddMemberWarning:true,participants:p,thread:r,viewerID:s}),c('React').createElement(c('MessengerGraphQLTokenizer.react'),{autoFocus:false,context:null,className:"_2el3",defaultEntries:t,enableMessageSearch:false,entries:this.state.newParticipants,excludeGroups:true,excludePages:true,forceHideClearButton:true,hasHoverState:false,hideViewWithEntries:false,onAddEntryAttempt:this.$RTCGroupCallAddMembersDialog4,onClear:this.$RTCGroupCallAddMembersDialog5,onRemoveEntryAttempt:this.$RTCGroupCallAddMembersDialog6,originalEntryIDs:c('immutable').Set(this.props.participants.keySeq().toArray().map(function(u){return c('MercuryIDs').getUserIDFromParticipantID(u)||u;})),placeholder:i._("Add to group:"),showDefaultEntries:true,shouldQueryInternalBot:false,shouldQueryVCEndpoint:false,scrollableViewClassName:"_2el2",useLayer:false,viewer:this.props.viewerID,width:m})));};n.prototype.$RTCGroupCallAddMembersDialog7=function(){if(this.state.newParticipants.size)if(c('MessengerAdminGroupUtils').isJoinableThread(this.props.thread)){this.state.newParticipants.forEach(function(p){var q=c('MercuryIDs').getThreadIDFromUserID(p.getUniqueID());this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructUserGeneratedMessageObject(this.props.thread.joinable_mode.link,c('MercuryTriodeSourceUtil').getMercuryTriodeSource(),q));}.bind(this));}else{var o='thread:'+(this.props.thread.thread_fbid||this.props.thread.thread_id.split('.')[1]);this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructLogMessageObject(c('MercuryTriodeSourceUtil').getMercuryTriodeSource(),o,c('MercuryLogMessageType').SUBSCRIBE,{added_participants:this.state.newParticipants.map(function(p){return c('MercuryIDs').getParticipantIDFromUserID(p.getUniqueID());}).toArray()}));}};n.prototype.$RTCGroupCallAddMembersDialog8=function(){return c('MercuryMessageActions').getForFBID(this.props.viewerID);};n.prototype.$RTCGroupCallAddMembersDialog9=function(){return c('MercuryMessageObject').getForFBID(this.props.viewerID);};n.prototype.$RTCGroupCallAddMembersDialog3=function(){return this.props.participants.filter(function(o,p){return this.state.isParticipantSelected.get(p);}.bind(this)).toArray();};f.exports=n;}),null);
__d('RTCIceCandidate',[],(function a(b,c,d,e,f,g){'use strict';f.exports=window.RTCIceCandidate||window.mozRTCPeerConnection;}),null);
__d('RTCPeerConnection',[],(function a(b,c,d,e,f,g){'use strict';f.exports=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;}),null);
__d('RTCSessionDescription',['FBRTCSdpUtils','FBRTCExperiment','MultiwayTypes','FBRTCConstants'],(function a(b,c,d,e,f,g){var h=c('MultiwayTypes').MediaType,i=c('FBRTCConstants').SignalingProtocol,j=window.RTCSessionDescription||window.mozRTCSessionDescription,k=2,l='o',m='m',n='a',o='rtpmap',p='ssrc-group',q='ssrc',r='cname',s='msid',t='mslabel',u='label',v='sendonly',w='recvonly',x='sendrecv',y='inactive',z='offer',aa='answer',ba='=',ca=' ',da=':',ea='\r\n',fa='audio',ga='video',ha=function oa(pa,qa){return pa.startsWith(qa+ba);},ia=function oa(pa){return pa.substr(k);},ja=function oa(pa,qa){return pa.startsWith(qa+ea)||pa.startsWith(qa+da);},ka=function oa(pa,qa){return pa.substr(qa.length+1);};function la(oa){'use strict';this.$SessionDescription1=[];this.$SessionDescription2='-';this.$SessionDescription3='multiway';this.$SessionDescription4=1;this.$SessionDescription5='IN';this.$SessionDescription6='IP4';this.$SessionDescription7='127.0.0.1';oa.forEach(function(pa){if(ha(pa,l)){var qa=ia(pa).split(ca);if(qa.length==6){this.$SessionDescription2=qa[0];this.$SessionDescription3=qa[1];this.$SessionDescription4=parseInt(qa[2],10);this.$SessionDescription5=qa[3];this.$SessionDescription6=qa[4];this.$SessionDescription7=qa[5];}}this.$SessionDescription1.push(pa);}.bind(this));}la.prototype.setVersion=function(oa){'use strict';this.$SessionDescription4=oa;};la.prototype.getVersion=function(){'use strict';return this.$SessionDescription4;};la.prototype.toSdp=function(){'use strict';return this.$SessionDescription1.map(function(oa){if(ha(oa,l)){return l+ba+this.$SessionDescription2+ca+this.$SessionDescription3+ca+this.$SessionDescription4+ca+this.$SessionDescription5+ca+this.$SessionDescription6+ca+this.$SessionDescription7;}else return oa;}.bind(this)).join(ea);};function ma(oa,pa){var qa=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];'use strict';this.$MediaDescription1=[];var ra={},sa=[],ta=[];oa.forEach(function(ua){var va=ia(ua);if(ha(ua,m))this.$MediaDescription4=va.split(ca)[0];if(ha(ua,n)&&ja(va,o)){var wa=ka(va,o),xa=wa.split(ca),ya=xa[0],za=xa[1];ra[za]=ya;}if(ha(ua,n)&&ja(va,q)){this.$MediaDescription6(va,sa);}else if(ha(ua,n)&&ja(va,p)){this.$MediaDescription7(va,ta);}else if(ha(ua,n)&&(va===v||va===w||va===x||va===y)){this.$MediaDescription5=va;}else this.$MediaDescription1.push(ua);}.bind(this));Object.keys(qa).forEach(function(ua){if(ra[ua]){var va=Object.keys(qa[ua]).map(function(wa){return wa+'='+qa[ua][wa];}).join(';');this.$MediaDescription1.push('a=fmtp:'+ra[ua]+' '+va);}}.bind(this));this.$MediaDescription3={};this.$MediaDescription2={};sa.forEach(function(ua){if(Object.prototype.hasOwnProperty.call(ua,r)){var va=ua.cname;if(!this.$MediaDescription3[va]){this.$MediaDescription3[va]=[ua];}else this.$MediaDescription3[va].push(ua);var wa=this.findSsrcGroupForSsrc(ta,ua.ssrc);if(wa){if(!this.$MediaDescription2[va]){this.$MediaDescription2[va]=[wa];}else this.$MediaDescription2[va].push(wa);this.removeSsrcGroup(wa,ta);}}}.bind(this));if(pa===z){if(sa.length===0){this.$MediaDescription5=w;}else this.$MediaDescription5=x;}else if(pa===aa)this.$MediaDescription5=x;}ma.prototype.getMediaType=function(){'use strict';return this.$MediaDescription4;};ma.prototype.findSsrcGroupForSsrc=function(oa,pa){'use strict';return oa.find(function(qa){var ra=qa.ssrcs;return ra.some(function(sa){return sa===pa;});});};ma.prototype.addStreamsForEndpoint=function(oa,pa){'use strict';this.$MediaDescription3[oa]=pa;};ma.prototype.addSsrcGroupsForEndpoint=function(oa,pa){'use strict';this.$MediaDescription3[oa].forEach(function(qa){var ra=qa.ssrc,sa=this.findSsrcGroupForSsrc(pa,ra);if(sa){if(!this.$MediaDescription2[oa]){this.$MediaDescription2[oa]=[sa];}else this.$MediaDescription2[oa].push(sa);this.removeSsrcGroup(sa,pa);}}.bind(this));};ma.prototype.removeSsrcGroup=function(oa,pa){'use strict';var qa=pa.indexOf(oa);if(qa!==-1)pa.splice(qa,1);};ma.prototype.$MediaDescription7=function(oa,pa){'use strict';var qa=ka(oa,p);if(qa){var ra=qa.split(ca),sa=ra[0],ta=ra.slice(1);pa.push({semantics:sa,ssrcs:ta.map(function(ua){return parseInt(ua,10);})});}};ma.prototype.$MediaDescription6=function(oa,pa){'use strict';var qa=oa.indexOf(ca),ra=oa.substr(0,qa),sa=parseInt(ka(ra,q),10),ta=oa.substr(qa+1),ua=pa.find(function(wa){return wa.ssrc===sa;});if(!ua){ua={};ua.ssrc=sa;pa.push(ua);}if(ja(ta,r)){ua.cname=ka(ta,r);}else if(ja(ta,s)){var va=ka(ta,s).split(ca);ua.msid={id:va[0],appdata:va[1]};}else if(ja(ta,t)){ua.mslabel=ka(ta,t);}else if(ja(ta,u))ua.label=ka(ta,u);};ma.prototype.toSdp=function(){'use strict';var oa=[];this.$MediaDescription1.forEach(function(ra){oa.push(ra);});for(var pa in this.$MediaDescription2)this.$MediaDescription2[pa].forEach(function(ra){oa.push(n+ba+p+da+ra.semantics+ca+ra.ssrcs.join(ca));});oa.push(n+ba+this.$MediaDescription5);for(var qa in this.$MediaDescription3)this.$MediaDescription3[qa].forEach(function(ra){if(ra.cname)oa.push(n+ba+q+da+ra.ssrc+ca+r+da+ra.cname);if(ra.msid)oa.push(n+ba+q+da+ra.ssrc+ca+s+da+ra.msid.id+(ra.msid.appdata?ca+ra.msid.appdata:''));if(ra.mslabel)oa.push(n+ba+q+da+ra.ssrc+ca+t+da+ra.mslabel);if(ra.label)oa.push(n+ba+q+da+ra.ssrc+ca+u+da+ra.label);});return oa.join(ea);};function na(oa){var pa=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],qa=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];'use strict';var ra=pa.type,sa=ra===undefined?'offer':ra,ta=pa.sdp,ua=ta===undefined?'':ta;this.$RTCSessionDescription1=oa;this.type=sa;if(oa===i.P2P){var va=[];if(this.type==='offer'){if(qa.DISABLE_VIDEO)va.push(function(ab){return c('FBRTCSdpUtils').disableVideo(ab);});va.push(function(ab){return c('FBRTCSdpUtils').addIceOptionToSdp(ab,'fb-force-5245');},function(ab){return c('FBRTCSdpUtils').replaceRTPSAVPFProfile(ab);},function(ab){return c('FBRTCSdpUtils').preferIsac(ab);},function(ab){return c('FBRTCSdpUtils').removeSdparta(ab);},function(ab){return c('FBRTCSdpUtils').addNullVideo(ab);});if(qa.ADD_AUDIO_NACK)va.push(function(ab){return c('FBRTCSdpUtils').addAudioNack(ab);});}else{va.push(function(ab){return c('FBRTCSdpUtils').addIceOptionToSdp(ab,'fb-force-5245');},function(ab){return c('FBRTCSdpUtils').addNullVideo(ab);});if(qa.USE_DTLS_OVER_CRYPTO)va.push(function(ab){return c('FBRTCSdpUtils').useDTLSOverCrypto(ab);});}this.$RTCSessionDescription2=va.reduce(function(ab,bb){return bb(ab);},ua);}else{var wa=ua.trim().split(ea),xa=0,ya=[];while(xa<wa.length&&!ha(wa[xa],m)){ya.push(wa[xa]);xa++;}this.sessionDescription=new la(ya);this.mediaDescriptions=[];while(xa<wa.length){var za=[];za.push(wa[xa]);xa++;while(xa<wa.length&&!ha(wa[xa],m)){za.push(wa[xa]);xa++;}this.mediaDescriptions.push(new ma(za,this.type,qa.FORMAT_PARAMETERS));}}}na.prototype.processServerMediaUpdate=function(oa){'use strict';var pa=oa.sourceKey,qa=oa.media,ra=oa.ssrcGroups,sa=[],ta=[];qa.forEach(function(ua){ua.ssrcs.forEach(function(va){var wa={ssrc:va,cname:pa,msid:{id:pa,appdata:ua.id},label:ua.id,mslabel:pa};if(h.AUDIO===ua.type){sa.push(wa);}else if(h.VIDEO===ua.type)ta.push(wa);});});this.mediaDescriptions.forEach(function(ua){if(ua.getMediaType()===fa){ua.addStreamsForEndpoint(pa,sa);ua.addSsrcGroupsForEndpoint(pa,ra);}else if(ua.getMediaType()===ga){ua.addStreamsForEndpoint(pa,ta);ua.addSsrcGroupsForEndpoint(pa,ra);}});};na.prototype.toDesc=function(){'use strict';return new j({type:this.type,sdp:this.toSdp()});};na.prototype.toSdp=function(){'use strict';var oa=this.$RTCSessionDescription1;switch(oa){case i.P2P:return this.$RTCSessionDescription2;case i.MULTIWAY:return this.sessionDescription.toSdp()+ea+this.mediaDescriptions.map(function(pa){return pa.toSdp();}).join(ea)+ea;default:throw new Error('Unknown signaling protocol '+oa);}};na.prototype.strongDiff=function(oa){'use strict';var pa=this.toSdp(),qa=oa.toSdp();return pa!==qa&&this.$RTCSessionDescription3(pa)!==this.$RTCSessionDescription3(qa);};na.prototype.$RTCSessionDescription3=function(oa){'use strict';return this.$RTCSessionDescription4(oa).split('\r\n').filter(function(pa){return !/^a=(candidate|setup):/.test(pa);}).join('\r\n');};na.prototype.$RTCSessionDescription4=function(oa){'use strict';return oa.replace(/(o=\S+\s\S+)\s\S+\s/,'$1 - ');};f.exports=na;}),null);
__d('FBRTCPeerConnection',['Promise','regeneratorRuntime','FBRTCSdpUtils','Map','RTCIceCandidate','RTCPeerConnection','RTCSessionDescription','UserAgent'],(function a(b,c,d,e,f,g){'use strict';function h(v){var w=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],x=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection7=new (c('Map'))();this.addEventListener=function(y,z){var aa=this.$FBRTCPeerConnection7.get(y);if(!Array.isArray(aa)){aa=[];this.$FBRTCPeerConnection7.set(y,aa);}aa.push(z);this.$FBRTCPeerConnection5.addEventListener(y,z);};this.removeEventListener=function(y,z){var aa=this.$FBRTCPeerConnection7.get(y);if(Array.isArray(aa)){aa=aa.filter(function(ba){return ba!==z;});if(aa.length<1){this.$FBRTCPeerConnection7['delete'](y);}else this.$FBRTCPeerConnection7.set(y,aa);}this.$FBRTCPeerConnection5.removeEventListener(y,z);};this.$FBRTCPeerConnection9=function(y){var z=y.candidate;if(z)this.$FBRTCPeerConnection4.push(z);}.bind(this);this.$FBRTCPeerConnection10=function(y){var z=y.channel;this.$FBRTCPeerConnection11(z);}.bind(this);this.$FBRTCPeerConnection6=v;this.$FBRTCPeerConnection1=w;this.$FBRTCPeerConnection2=x;this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8();}h.prototype.$FBRTCPeerConnection8=function(){var v=new (c('RTCPeerConnection'))(this.$FBRTCPeerConnection1,this.$FBRTCPeerConnection2);v.addEventListener('icecandidate',this.$FBRTCPeerConnection9);v.addEventListener('datachannel',this.$FBRTCPeerConnection10);for(var w=this.$FBRTCPeerConnection7.entries(),x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z,ba=aa[0],ca=aa[1];for(var da=ca,ea=Array.isArray(da),fa=0,da=ea?da:da[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ga;if(ea){if(fa>=da.length)break;ga=da[fa++];}else{fa=da.next();if(fa.done)break;ga=fa.value;}var ha=ga;v.addEventListener(ba,ha);}}return v;};h.prototype.reset=function(){var v=this.$FBRTCPeerConnection5;for(var w=this.$FBRTCPeerConnection7.entries(),x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z,ba=aa[0],ca=aa[1];for(var da=ca,ea=Array.isArray(da),fa=0,da=ea?da:da[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ga;if(ea){if(fa>=da.length)break;ga=da[fa++];}else{fa=da.next();if(fa.done)break;ga=fa.value;}var ha=ga;v.removeEventListener(ba,ha);}}v.removeEventListener('datachannel',this.$FBRTCPeerConnection9);v.removeEventListener('icecandidate',this.$FBRTCPeerConnection9);this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8();for(var ia=v.getLocalStreams(),ja=Array.isArray(ia),ka=0,ia=ja?ia:ia[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var la;if(ja){if(ka>=ia.length)break;la=ia[ka++];}else{ka=ia.next();if(ka.done)break;la=ka.value;}var ma=la;this.addStream(ma);}return c('Promise').race([new (c('Promise'))(function(na){var oa=this.$FBRTCPeerConnection5,pa=function qa(ra){var sa=ra.target;if(sa.iceConnectionState!=='checking'&&sa.iceConnectionState!=='new'){na();oa.removeEventListener('iceconnectionstatechange',qa);q(v);}};oa.addEventListener('iceconnectionstatechange',pa);}.bind(this)),new (c('Promise'))(function(na){return setTimeout(na,5000);})])['catch'](function(na){return c('Promise').resolve();}).then(function(){q(v);});};h.prototype.close=function(){q(this.$FBRTCPeerConnection5);};h.prototype.getCreatedIceCandidates=function(){return this.$FBRTCPeerConnection4;};h.prototype.$FBRTCPeerConnection11=function(v){v.addEventListener('close',function(){this.$FBRTCPeerConnection3=this.$FBRTCPeerConnection3.filter(function(w){return w!==v;});}.bind(this));this.$FBRTCPeerConnection3.push(v);};h.prototype.onReceivedRemoteIceCandidate=function(v){var w=v.sdp,x=v.label,y=v.sdp_mid,z=new (c('RTCIceCandidate'))({sdpMLineIndex:x,candidate:c('FBRTCSdpUtils').fixMobileIceSdp(w),sdpMid:y});this.$FBRTCPeerConnection5.addIceCandidate(z);};h.prototype.getLocalStreams=function(){return this.$FBRTCPeerConnection5.getLocalStreams();};h.prototype.getRemoteStreams=function(){return this.$FBRTCPeerConnection5.getRemoteStreams();};h.prototype.addStream=function(v){if(r('addTrack')){for(var w=v.getTracks(),x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z;this.$FBRTCPeerConnection5.addTrack(aa,v);}}else this.$FBRTCPeerConnection5.addStream(v);};h.prototype.removeStream=function(v){var w,x=this;if(r('removeTrack')&&r('getSenders')){(function(){var y=v.getTracks(),z=x.$FBRTCPeerConnection5.getSenders().filter(function(fa){return y.includes(fa.track);});for(var aa=z,ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da;if(ba){if(ca>=aa.length)break;da=aa[ca++];}else{ca=aa.next();if(ca.done)break;da=ca.value;}var ea=da;x.$FBRTCPeerConnection5.removeTrack(ea);}})();}else this.$FBRTCPeerConnection5.removeStream(v);};h.prototype.createOffer=function v(){var w=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],x=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],y=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return c('regeneratorRuntime').async(function z(aa){while(1)switch(aa.prev=aa.next){case 0:return aa.abrupt('return',j(this.$FBRTCPeerConnection5,w).then(function(ba){ba.sdp=y.audio?c('FBRTCSdpUtils').preferCodec(ba.sdp,y.audio,false):ba.sdp;ba.sdp=y.video?c('FBRTCSdpUtils').preferCodec(ba.sdp,y.video,true):ba.sdp;return new (c('RTCSessionDescription'))(this.$FBRTCPeerConnection6,ba,{FORMAT_PARAMETERS:x});}.bind(this)));case 1:case 'end':return aa.stop();}},null,this);};h.prototype.createAnswer=function v(){return c('regeneratorRuntime').async(function w(x){while(1)switch(x.prev=x.next){case 0:return x.abrupt('return',k(this.$FBRTCPeerConnection5).then(function(y){return new (c('RTCSessionDescription'))(this.$FBRTCPeerConnection6,y);}.bind(this)));case 1:case 'end':return x.stop();}},null,this);};h.prototype.setLocalDescription=function v(w){return c('regeneratorRuntime').async(function x(y){while(1)switch(y.prev=y.next){case 0:return y.abrupt('return',o(this.$FBRTCPeerConnection5,w.toDesc()).then(function(){return w;}));case 1:case 'end':return y.stop();}},null,this);};h.prototype.setRemoteDescription=function v(w){return c('regeneratorRuntime').async(function x(y){while(1)switch(y.prev=y.next){case 0:return y.abrupt('return',p(this.$FBRTCPeerConnection5,w.toDesc()).then(function(){return w;}));case 1:case 'end':return y.stop();}},null,this);};h.prototype.getLocalDescription=function(){return new (c('RTCSessionDescription'))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.localDescription||{});};h.prototype.getRemoteDescription=function(){return new (c('RTCSessionDescription'))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.remoteDescription||{});};h.prototype.getSignalingState=function(){return this.$FBRTCPeerConnection5.signalingState;};h.prototype.getIceGatheringState=function(){return this.$FBRTCPeerConnection5.iceGatheringState;};h.prototype.getIceConnectionState=function(){return this.$FBRTCPeerConnection5.iceConnectionState;};h.prototype.getStats=function v(w){return c('regeneratorRuntime').async(function x(y){while(1)switch(y.prev=y.next){case 0:if(!(w!=null)){y.next=2;break;}return y.abrupt('return',c('Promise').reject(new Error('getStats() doesn\'t support selector (yet)')));case 2:if(!c('UserAgent').isBrowser('Edge')){y.next=4;break;}return y.abrupt('return',c('Promise').resolve(new (c('Map'))()));case 4:if(!c('UserAgent').isBrowser('Firefox')){y.next=6;break;}return y.abrupt('return',c('Promise').resolve(this.$FBRTCPeerConnection5.getStats()).then(function(z){if(c('UserAgent').isBrowser('Firefox >= 48'))return z;return t(z);}).then(function(z){if(c('UserAgent').isBrowser('Firefox >= 53'))return z;try{z.forEach(function(aa){aa.type=u(aa.type);});}catch(aa){if(aa.name!=='TypeError')throw aa;z.forEach(function(ba,ca){z.set(ca,babelHelpers['extends']({},ba,{type:u(ba.type)}));});}return z;}));case 6:if(!(c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))){y.next=8;break;}return y.abrupt('return',new (c('Promise'))(function(z,aa){this.$FBRTCPeerConnection5.getStats(z,aa);}.bind(this)).then(function(z){var aa={};for(var ba=z.result(),ca=Array.isArray(ba),da=0,ba=ca?ba:ba[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ea;if(ca){if(da>=ba.length)break;ea=ba[da++];}else{da=ba.next();if(da.done)break;ea=da.value;}var fa=ea,ga={id:fa.id,timestamp:fa.timestamp,type:u(fa.type)};for(var ha=fa.names(),ia=Array.isArray(ha),ja=0,ha=ia?ha:ha[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ka;if(ia){if(ja>=ha.length)break;ka=ha[ja++];}else{ja=ha.next();if(ja.done)break;ka=ja.value;}var la=ka;ga[la]=fa.stat(la);}aa[ga.id]=ga;}return aa;}).then(t));case 8:return y.abrupt('return',c('Promise').reject(new Error('getStats() not supported')));case 9:case 'end':return y.stop();}},null,this);};h.prototype.createDataChannel=function(v,w){if(this.$FBRTCPeerConnection5.createDataChannel){var x=this.$FBRTCPeerConnection5.createDataChannel(v,w);this.$FBRTCPeerConnection11(x);return x;}return null;};h.prototype.getDataChannelByLabel=function(v){return this.$FBRTCPeerConnection3.find(function(w){return w.label===v;});};var i=c('UserAgent').isBrowser('Chrome < 52')||c('UserAgent').isBrowser('Opera < 39')||c('UserAgent').isBrowser('Firefox < 37');function j(v,w){if(i)return new (c('Promise'))(function(x,y){return v.createOffer(x,y,m(w));});return c('Promise').resolve(v.createOffer(m(w)));}function k(v){if(i)return new (c('Promise'))(function(w,x){return v.createAnswer(w,x);});return c('Promise').resolve(v.createAnswer());}var l=c('UserAgent').isBrowser('Chrome < 38')||c('UserAgent').isBrowser('Opera < 26');function m(v){var w=v.offerToReceiveAudio,x=w===undefined?true:w,y=v.offerToReceiveVideo,z=y===undefined?true:y,aa=babelHelpers.objectWithoutProperties(v,['offerToReceiveAudio','offerToReceiveVideo']);if(l){if(Object.keys(aa).length>0)return {mandatory:{OfferToReceiveAudio:x,OfferToReceiveVideo:z},optional:babelHelpers['extends']({},s(aa))};return {mandatory:{OfferToReceiveAudio:x,OfferToReceiveVideo:z}};}return babelHelpers['extends']({offerToReceiveAudio:x,offerToReceiveVideo:z},aa);}var n=c('UserAgent').isBrowser('Chrome < 51')||c('UserAgent').isBrowser('Opera < 38')||c('UserAgent').isBrowser('Firefox < 37');function o(v,w){if(n)return new (c('Promise'))(function(x,y){return v.setLocalDescription(w,x,y);});return c('Promise').resolve(v.setLocalDescription(w));}function p(v,w){if(n)return new (c('Promise'))(function(x,y){return v.setRemoteDescription(w,x,y);});return c('Promise').resolve(v.setRemoteDescription(w));}function q(v){if(v&&v.signalingState!=='closed')v.close();}function r(v){return v in c('RTCPeerConnection').prototype;}function s(v){var w={};for(var x=Object.keys(v),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var aa;if(y){if(z>=x.length)break;aa=x[z++];}else{z=x.next();if(z.done)break;aa=z.value;}var ba=aa,ca=''+ba.substr(0,1).toUpperCase()+ba.substr(1);w[ca]=v[ba];}return w;}function t(v){return new (c('Map'))(Object.keys(v).map(function(w){return [w,v[w]];}));}function u(v){switch(v){case 'inbound-rtp':return 'inboundrtp';case 'outbound-rtp':return 'outboundrtp';case 'candidate-pair':return 'candidatepair';case 'local-candidate':return 'localcandidate';case 'remote-candidate':return 'remotecandidate';default:return v;}}f.exports=h;}),null);
__d("XGroupCallSendRequestController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/groupcall\/sendrequest\/",{webrtc_fbtrace:{type:"Int"}});}),null);
__d('MultiwayRequests',['Promise','RTCUtils','XGroupCallSendRequestController','AsyncRequest','MultiwayTypes'],(function a(b,c,d,e,f,g){'use strict';var h=15000,i=c('MultiwayTypes').MessageType,j=c('MultiwayTypes').Capability;function k(){}k.prototype.sendJoinRequest=function(l,m,n,o,p,q){var r=c('RTCUtils').createRequestHeader(i.JOIN,m,n),s={offer:{sdpString:o.toSdp()},deviceCapabilities:[j.SUPPORT_AUDIO,j.SUPPORT_VIDEO]};if(p&&p.length>0)s.usersToCall=p;if(q)s.mediaStatus=q;var t={endpoint:l,jsonPayload:{header:r,body:{joinRequest:s}}};return this.$MultiwayRequests1(t);};k.prototype.sendHangupRequest=function(l,m,n,o,p){var q=c('RTCUtils').createRequestHeader(i.HANGUP,m,n),r={reason:o,detailedReasonString:p},s={endpoint:l,jsonPayload:{header:q,body:{hangupRequest:r}}};return this.$MultiwayRequests1(s);};k.prototype.sendAddParticipantsRequest=function(l,m,n,o){var p=c('RTCUtils').createRequestHeader(i.ADD_PARTICIPANTS,m,n),q={usersToInvite:o},r={endpoint:l,jsonPayload:{header:p,body:{addParticipantsRequest:q}}};return this.$MultiwayRequests1(r);};k.prototype.sendSubscriptionRequest=function(l,m,n,o){return this.$MultiwayRequests1({endpoint:l,jsonPayload:{header:c('RTCUtils').createRequestHeader(i.SUBSCRIPTION,m,n),body:{subscriptionRequest:{subscriptions:o}}}});};k.prototype.sendClientMediaUpdateRequest=function(l,m,n,o,p,q){return this.$MultiwayRequests1({endpoint:l,jsonPayload:{header:c('RTCUtils').createRequestHeader(i.CLIENT_MEDIA_UPDATE,m,n),body:{clientMediaUpdateRequest:{fromVersion:o,toVersion:p,mediaUpdates:q}}}});};k.prototype.$MultiwayRequests1=function(l){return new (c('Promise'))(function(m,n){var o=c('XGroupCallSendRequestController').getURIBuilder().getURI(),p=new (c('AsyncRequest'))(o).setMethod('POST').setData({request:JSON.stringify(l)}).setAllowCrossPageTransition(true).setHandler(function(q){m(q.payload);}).setErrorHandler(function(q){var r=Error(q.getErrorDescription?q.getErrorDescription():'AsyncRequest error');n(r);}).setTimeoutHandler(h,function(){n('Timeout');});p.send();});};f.exports=new k();}),null);
__d('RTCMWProtocolHandler',['regeneratorRuntime','Promise','FBRTCConstants','ChannelManager','CurrentUser','FBRTCCallSummary','FBRTCCallSummaryStore','FBRTCGroupCallStore','FBRTCPeerConnection','FBRTCSdpUtils','MercuryIDs','MercuryParticipants','MultiwayRequests','RTCCallActions','RTCCallStore','RTCConfig','MultiwayTypes','RTCGroupCallActions','RTCMultiwayMessageHandler','RTCSessionDescription','RTCUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBRTCConstants').CallEndReason,i=c('FBRTCConstants').CallType,j=c('FBRTCConstants').GroupVideoViewLayout,k=c('FBRTCConstants').IceConnectionState,l=c('FBRTCConstants').SignalingProtocol,m=c('MultiwayTypes').RtcResponseStatusCode,n=c('MultiwayTypes').VideoQuality,o='229895473858072',p=180000,q={appId:o,deviceId:c('ChannelManager').getCompleteConfig().sessionID,userId:c('CurrentUser').getID()};c('ChannelManager').startChannelManager();function r(){var t=arguments.length<=0||arguments[0]===undefined?null:arguments[0];this.$RTCMWProtocolHandler4=false;this.$RTCMWProtocolHandler5=function(u){var v=u.target;c('RTCCallActions').emit('onIceConnectionStateChange',v.iceConnectionState);switch(v.iceConnectionState){case k.DISCONNECTED:case k.FAILED:if(!this.$RTCMWProtocolHandler2)this.$RTCMWProtocolHandler2=setTimeout(function(){c('RTCCallActions').endCall(h.CONNECTION_DROPPED,'ConnectionDropped');var w=c('RTCCallStore').getState(),x=w.connections;c('RTCMultiwayMessageHandler').close();x.forEach(function(y){return y.close();});c('RTCCallActions').removeAllLocalStreams(true);},p);break;default:clearTimeout(this.$RTCMWProtocolHandler2);this.$RTCMWProtocolHandler2=null;}}.bind(this);this.$RTCMWProtocolHandler1=t;}r.prototype.startCall=function(t,u,v,w){var x=w.callTrigger,y=w.formatParameters,z=y===undefined?{}:y,aa=w.preferredCodecs,ba=aa===undefined?{}:aa,ca=w.serverInfoData,da=w.shouldSetDescriptions,ea=da===undefined?true:da;c('RTCCallActions').initialize(l.MULTIWAY,v,ca,this.$RTCMWProtocolHandler1,x);var fa=c('FBRTCCallSummary').restoreOrInitialize(c('FBRTCCallSummaryStore').getInstance(),c('RTCUtils').isGroupCall(v)?-1:c('RTCUtils').getPeerID(v),this.$RTCMWProtocolHandler1,!ca);x&&fa.onCallStarted(x);fa.setIsUsingMultiway(1);fa.onPopupOpened();fa.setConferenceName(v);fa.setServerInfoData(ca);fa.save(c('FBRTCCallSummaryStore').getInstance());c('RTCCallActions').setCallSummary(fa);c('RTCGroupCallActions').setMWCallType(u.some(function(ja){return ja.getVideoTracks().length>0;})?i.DIRECT_VIDEO:i.VOIP);var ga={mandatory:{},optional:[{googNumUnsignalledRecvStreams:10},{googHighBitrate:true},{googVeryHighBitrate:true},{RtpDataChannels:true}]};if(!c('RTCConfig').RtcUseDtlsGK)ga.optional.push({DtlsSrtpKeyAgreement:false});var ha=new (c('FBRTCPeerConnection'))(l.MULTIWAY,{iceServers:[]},ga),ia=ha.createDataChannel('data');if(ia)ia.onmessage=function(ja){var ka=ja.data;try{var la=JSON.parse(ka),ma=la.body;if(ma.dominantSpeakerNotification){var na=ma.dominantSpeakerNotification.userId;c('RTCGroupCallActions').setDominantSpeaker(na);}}catch(oa){}};ha.addEventListener('addstream',function(event){event.stream.onaddtrack=function(ka){var la=ka.target,ma=ka.track;c('RTCCallActions').addRemoteTrack(la,ma);};event.stream.onremovetrack=function(ka){var la=ka.target,ma=ka.track;c('RTCCallActions').removeRemoteTrack(la,ma);};var ja=c('MercuryIDs').getParticipantIDFromUserID(event.stream.id.split(':')[0]);c('MercuryParticipants').get(ja,function(ka){var la={};la[ja]=ka;c('RTCGroupCallActions').onParticipantsAdded(la);c('RTCCallActions').addRemoteStream(event.stream);var ma=c('RTCCallStore').getState(),na=ma.callInfo,oa=ma.connections,pa=c('FBRTCGroupCallStore').getState(),qa=pa.layout,ra=pa.pinnedSpeakerFBID;r.subscription(na.conferenceName,na.serverInfoData,oa.first().getRemoteStreams(),qa,ra);});});ha.addEventListener('removestream',function(event){c('RTCCallActions').removeRemoteStream(event.stream);});ha.addEventListener('iceconnectionstatechange',this.$RTCMWProtocolHandler5);this.$RTCMWProtocolHandler6(ha,u,v,ca,t,z,ba,ea);if(!ca){c('RTCCallActions').call(t,ha);}else c('RTCCallActions').join(ha);return ha;};r.prototype.setDescriptions=function(){this.$RTCMWProtocolHandler4=true;var t=c('RTCCallStore').getState().connections.first();if(this.$RTCMWProtocolHandler3)t.setRemoteDescription(this.$RTCMWProtocolHandler3);};r.videoEscalation=function(){return c('RTCUtils').initLocalStream(true).then(function(t){var u=c('RTCCallStore').getState(),v=u.callInfo,w=v.conferenceName,x=v.serverInfoData,y=u.connections,z=u.localUser;t.getTracks().forEach(function(ba){if(ba.kind==='audio')ba.enabled=!z.isAudioMuted();});var aa=z.getStreams().first();y.first().removeStream(aa);return s(y.first(),[t],w,x,[]).then(function(){c('RTCCallActions').removeLocalStream(aa);c('RTCCallActions').addLocalStream(t);c('RTCGroupCallActions').setMWCallType(i.ESCALATED);});});};r.endCall=function(t,u,v){var w=arguments.length<=3||arguments[3]===undefined?'':arguments[3];c('RTCMultiwayMessageHandler').close();c('RTCCallActions').removeAllLocalStreams(true);c('RTCCallActions').hangup(v,w);c('MultiwayRequests').sendHangupRequest(q,t,u,v,w||'Hangup by user').done(c('RTCCallActions').hangupSuccess,c('RTCCallActions').hangupError);};r.otherUserInAnotherCall=function(t,u,v){var w=arguments.length<=3||arguments[3]===undefined?'':arguments[3];c('MultiwayRequests').sendHangupRequest(q,t,u,v,w||'User receiving this call is in another call').done();};r.prototype.iceRestart=function(t,u){s(c('RTCCallStore').getState().connections.first(),[],t,u,[],{iceRestart:true});};r.addParticipants=function(t,u,v){c('MultiwayRequests').sendAddParticipantsRequest(q,t,u,v);};r.subscription=function(t,u,v,w,x){var y=w===j.DOMINANT_SPEAKER?n.LOW:w===j.GRID?n.MEDIUM:n.HIGH,z=v.map(function(aa){var ba=aa.id;return {cname:ba,options:{videoQuality:w===j.DOMINANT_SPEAKER&&x===ba.split(':')[0]?n.HIGH:y}};});if(w===j.DOMINANT_SPEAKER&&!x)z.push({cname:''});c('MultiwayRequests').sendSubscriptionRequest(q,t,u,z);};r.clientMediaUpdate=function(t,u,v,w,x){c('MultiwayRequests').sendClientMediaUpdateRequest(q,t,u,v,w,x).then(function(y){var z=y.header.responseStatusCode,aa=y.body.clientMediaUpdateResponse.currentVersion;return c('RTCGroupCallActions').onClientMediaUpdateResponse(z,aa);})['catch'](function(y){});};r.prototype.$RTCMWProtocolHandler6=function(t,u,v,w,x,y,z,aa){this.$RTCMWProtocolHandler7(v,w);s(t,u,v,w,x,{},y,z,aa).done(function(ba){this.$RTCMWProtocolHandler3=ba;if(this.$RTCMWProtocolHandler4)this.setDescriptions();c('RTCCallActions').callSuccess();}.bind(this),function(ba){c('RTCCallActions').callError(ba);var ca=c('RTCCallStore').getState(),da=ca.connections;c('RTCMultiwayMessageHandler').close();da.forEach(function(ea){return ea.close();});c('RTCCallActions').removeAllLocalStreams(true);});};r.prototype.$RTCMWProtocolHandler7=function(t,u){c('RTCMultiwayMessageHandler').initHandler(t,u);};function s(t,u,v,w,x){var y=arguments.length<=5||arguments[5]===undefined?{}:arguments[5],z=arguments.length<=6||arguments[6]===undefined?{}:arguments[6],aa=arguments.length<=7||arguments[7]===undefined?{}:arguments[7],ba=arguments.length<=8||arguments[8]===undefined?true:arguments[8],ca,da,ea,fa,ga,ha;return c('regeneratorRuntime').async(function ia(ja){while(1)switch(ja.prev=ja.next){case 0:ca={};da=[];u.forEach(function(ka){da.concat(ka.getTracks());t.addStream(ka);});da.forEach(function(ka){ca[ka.id]=true;});ja.next=6;return c('regeneratorRuntime').awrap(t.createOffer(y,z,aa));case 6:ea=ja.sent;if(c('FBRTCSdpUtils').validateOfferSdp(v,ea.toSdp())){ja.next=9;break;}throw m.BAD_REQUEST;case 9:ja.next=11;return c('regeneratorRuntime').awrap(t.setLocalDescription(ea));case 11:c('RTCGroupCallActions').onJoinRequestSent();ja.next=14;return c('regeneratorRuntime').awrap(c('MultiwayRequests').sendJoinRequest(q,v,w,ea,x.length>0?x:null,da.length>0?ca:null));case 14:fa=ja.sent;ga=fa.header.responseStatusCode;if(!(ga!==m.OK)){ja.next=18;break;}return ja.abrupt('return',new (c('Promise'))(function(ka,la){la(ga);}));case 18:c('RTCGroupCallActions').onJoinResponse(fa.header.serverInfoData);ha=new (c('RTCSessionDescription'))(l.MULTIWAY,{type:'answer',sdp:fa.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:z});if(!ba){ja.next=23;break;}ja.next=23;return c('regeneratorRuntime').awrap(t.setRemoteDescription(ha));case 23:c('RTCGroupCallActions').toggleRemoteStream(fa.body.joinResponse.mediaStatus);return ja.abrupt('return',ha);case 25:case 'end':return ja.stop();}},null,this);}f.exports=r;}),null);
__d('FBRTCGroupCallIncomingController',['FBRTCCallBlockingStore','FBRTCCallSummary','FBRTCCallSummaryStore','FBRTCConstants','FBRTCSupport','MessengerRTCGroupCallUnsupportedBrowserDialogController','MultiwayTypes','RTCMWProtocolHandler','RTCUtils','FBRTCCallUIWrapper','FBRTCTransactions','RTCConfig','FBRTCMultiwayMessage'],(function a(b,c,d,e,f,g){var h,i,j=c('FBRTCTransactions').FBRTCTransactionOwner,k=c('MultiwayTypes').HangupReason,l=c('MultiwayTypes').Capability,m=c('MultiwayTypes').RtcResponseStatusCode,n=c('MultiwayTypes').DeviceStatus,o=c('MultiwayTypes').RingType;h=babelHelpers.inherits(p,j);i=h&&h.prototype;function p(q){'use strict';i.constructor.call(this);this.$FBRTCGroupCallIncomingController1=q;this.$FBRTCGroupCallIncomingController2=null;}p.prototype.onMessageReceived=function(q){'use strict';var r=new (c('FBRTCMultiwayMessage'))(q),s=this.getTransaction(r);s.start().then(function(t){if(t!=null)if(t.ringRequest()!=null){if(c('RTCUtils').isMessengerCall(t.conferenceName())&&!c('RTCConfig').RtcWwwMessengerPrefix||!c('RTCUtils').isGroupCall(t.conferenceName())&&!c('RTCConfig').RTCConferencingP2PCanReceiveGK)return;var u=c('RTCUtils').generateRandomInt(),v=new (c('FBRTCCallSummary'))({peerID:c('RTCUtils').isGroupCall(t.conferenceName())||c('RTCUtils').isMessengerCall(t.conferenceName())?-1:c('RTCUtils').getPeerID(t.conferenceName()),callID:u,isCaller:false});if(c('FBRTCCallBlockingStore').getBlockingStatus()){v.onCallEnded(c('FBRTCConstants').CallEndReason.IGNORE_CALL,false,false,'calling disabled');v.save(c('FBRTCCallSummaryStore').getInstance());return;}if(!c('FBRTCSupport').isGroupCallWebtrcSupported()){v.onCallEnded(c('FBRTCConstants').CallEndReason.UNSUPPORTED_VERSION,false);v.save(c('FBRTCCallSummaryStore').getInstance());var w=t.ringRequest(),x=w.ringType;c('MessengerRTCGroupCallUnsupportedBrowserDialogController').render({hasVideo:c('RTCConfig').RtcConferencingVideoGK&&(x===o.GROUP_VIDEO_CALL||x===o.PEER_VIDEO_CALL)});return;}s.sendResponse(this.handleRingRequest(t,u,v));}else if(t.dismissRequest()!=null){s.sendResponse(this.handleDismissRequest(t));}}.bind(this),function(t){}).done();};p.prototype.cancelIncomingCallDialog=function(){'use strict';if(this.$FBRTCGroupCallIncomingController2){this.$FBRTCGroupCallIncomingController2.cancel();this.$FBRTCGroupCallIncomingController2=null;}};p.prototype.handleDismissRequest=function(q){'use strict';c('MessengerRTCGroupCallUnsupportedBrowserDialogController').unmount();if(this.$FBRTCGroupCallIncomingController2){var r=this.$FBRTCGroupCallIncomingController2.serverInfoData();if(r==q.serverInfoData()){this.cancelIncomingCallDialog();}}return q.createResponse(m.OK,{});};p.prototype.handleRingRequest=function(q,r,s){'use strict';var t=q.ringRequest(),u=q.serverInfoData();if(t==null||u==null)return q.createResponse(m.BAD_REQUEST);var v=t.caller,w=t.otherParticipants,x=c('RTCConfig').RtcConferencingVideoGK&&(t.ringType==o.GROUP_VIDEO_CALL||t.ringType==o.PEER_VIDEO_CALL),y=new this.$FBRTCGroupCallIncomingController1(q.conferenceName(),r,v,w,x,u);y.addListener('answerCall',function(aa,ba){c('FBRTCCallUIWrapper').openGroupCallURI(aa,r,x,u,'answer button',s);});y.addListener('ignoreCall',function(){c('RTCMWProtocolHandler').endCall(q.conferenceName(),u,k.IGNORE_CALL);s.onCallEnded(c('FBRTCConstants').CallEndReason.IGNORE_CALL,false);s.save(c('FBRTCCallSummaryStore').getInstance());this.cancelIncomingCallDialog();}.bind(this));y.addListener('timeout',function(){c('RTCMWProtocolHandler').endCall(q.conferenceName(),u,k.NO_ANSWER_TIMEOUT);s.onCallEnded(c('FBRTCConstants').CallEndReason.NO_ANSWER_TIMEOUT,false);s.save(c('FBRTCCallSummaryStore').getInstance());this.cancelIncomingCallDialog();}.bind(this));this.$FBRTCGroupCallIncomingController2=y;y.showIncomingDialog();var z={deviceCapabilities:[l.SUPPORT_AUDIO,l.SUPPORT_VIDEO],deviceStatus:n.OK};return q.createResponse(m.OK,{ringResponse:z});};f.exports=p;}),null);